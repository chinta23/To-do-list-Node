-- MySQL dump 10.13  Distrib 5.7.9, for Win64 (x86_64)
--
-- Host: localhost    Database: to_do_list
-- ------------------------------------------------------
-- Server version	5.7.11-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `category`
--

DROP TABLE IF EXISTS `category`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `category` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `category_name` varchar(255) DEFAULT NULL,
  `mdr_type_id` int(11) NOT NULL,
  `createdAt` datetime DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`,`mdr_type_id`),
  KEY `mdr_type_id` (`mdr_type_id`),
  CONSTRAINT `Category_ibfk_1` FOREIGN KEY (`mdr_type_id`) REFERENCES `mdrtype` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=25 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `category`
--

LOCK TABLES `category` WRITE;
/*!40000 ALTER TABLE `category` DISABLE KEYS */;
INSERT INTO `category` VALUES (14,'Proxy',1,NULL,NULL),(15,'UTM',1,NULL,NULL),(16,'Server',1,NULL,NULL),(17,'LEC VM - Startup Guide',1,NULL,NULL),(18,'Wireless Controllers',1,NULL,NULL),(19,'Routers & Switches',1,NULL,NULL),(20,'Load Balancer\n',1,NULL,NULL),(21,'Others.\n',1,NULL,NULL),(22,'WAF',1,NULL,NULL),(23,'APT',1,NULL,NULL),(24,'IDS',1,NULL,NULL);
/*!40000 ALTER TABLE `category` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `faq`
--

DROP TABLE IF EXISTS `faq`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `faq` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `question` varchar(255) DEFAULT NULL,
  `answer` text,
  `mdr_type_id` int(11) NOT NULL,
  `order` int(11) DEFAULT NULL,
  `createdAt` datetime DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`,`mdr_type_id`),
  KEY `mdr_type_id` (`mdr_type_id`),
  CONSTRAINT `Faq_ibfk_1` FOREIGN KEY (`mdr_type_id`) REFERENCES `mdrtype` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `faq`
--

LOCK TABLES `faq` WRITE;
/*!40000 ALTER TABLE `faq` DISABLE KEYS */;
INSERT INTO `faq` VALUES (1,'a','b',2,1,NULL,NULL),(8,'What is a virtual machine (VM)','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">A virtual machine (VM) is an operating system (OS) or application environment that is installed on software, which imitates dedicated hardware. The end user has the same experience on a virtual machine as they would have on dedicated hardware.</span></span><br />\n&nbsp;</p>\n</body>\n</html>\n',1,5,NULL,NULL),(9,'What is an OVA file?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">An OVA file is a virtual appliance used by virtualization applications such as VMware Workstation and Oracle VM Virtual box.</span></span></p>\n</body>\n</html>\n',1,9,NULL,NULL),(10,'What is a VHD file?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">A VHD file contains a virtual hard disk image used by Microsoft Windows Virtual PC, a Windows virtualization program. It stores the contents of a hard disk of a virtual machine (VM), which may include disk partitions, a file system, files, and folders, VHD file will be used in hyper V enabled platform&rsquo;s.</span></span></p>\n</body>\n</html>\n',1,7,NULL,NULL),(12,'How long does it take to download LEC VM?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:14px\">Download times vary by location, internet connection speed. It is recommended that uninterrupted good broadband connections are used to download.</span></span></p>\n</body>\n</html>\n',1,6,NULL,NULL),(13,'Is LEC VM is safe, in our network?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>We have taken precautionary measures and hardened OS to be safe if any abnormalities observer please feel free to reach us on adr.support@paladion.net.</p>\n</body>\n</html>\n',1,10,NULL,NULL),(14,'What needs to be done after I download LEC VM?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">We have placed detailed start-up guide on POC-Setup page (Step 1.b), please follow steps to setup LEC.</span></span></p>\n</body>\n</html>\n',1,11,NULL,NULL),(15,'I am having trouble downloading, what else should I do?','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Some pop-up blocker and firewall programs, as well as proxy servers, may prevent communication with our server. If you use these types of applications, you may need to check with your system admin team to allow blocks.</p>\n\n<p>If system admin requires more assistance, please contact our technical support @ adr.support@paladion.net.</p>\n</body>\n</html>\n',1,13,NULL,NULL),(16,'Ask our experts.!','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">If you have any questions that we haven&#39;t been able to answer, we would love to hear from you! Please reach us on adr.support@paladion.net</span></span></p>\n\n<p>&nbsp;</p>\n</body>\n</html>\n',1,8,NULL,NULL),(19,NULL,NULL,1,14,NULL,NULL);
/*!40000 ALTER TABLE `faq` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `mdr`
--

DROP TABLE IF EXISTS `mdr`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `mdr` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(255) DEFAULT NULL,
  `short_desc` varchar(255) DEFAULT NULL,
  `long_desc` longtext,
  `type_id` int(11) NOT NULL,
  `category_id` int(11) NOT NULL,
  `createdAt` datetime DEFAULT NULL,
  `mdr_type_id` int(11) NOT NULL,
  `view` int(11) DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`,`type_id`,`category_id`,`mdr_type_id`),
  KEY `type_id` (`type_id`),
  KEY `category_id` (`category_id`),
  KEY `mdr_type_id` (`mdr_type_id`),
  CONSTRAINT `Mdr_ibfk_1` FOREIGN KEY (`type_id`) REFERENCES `type` (`id`) ON DELETE CASCADE,
  CONSTRAINT `Mdr_ibfk_2` FOREIGN KEY (`category_id`) REFERENCES `category` (`id`) ON DELETE CASCADE,
  CONSTRAINT `Mdr_ibfk_3` FOREIGN KEY (`mdr_type_id`) REFERENCES `mdrtype` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=64 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `mdr`
--

LOCK TABLES `mdr` WRITE;
/*!40000 ALTER TABLE `mdr` DISABLE KEYS */;
INSERT INTO `mdr` VALUES (7,'Log forwarding steps ','Log forwarding steps for Forcepoint version 8.0','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1.&nbsp; Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Version 8.0 and above are supported.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2.&nbsp; Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Admin Privileges on Websense Proxy</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Make sure an instance of Websense Multiplexer is installed for each Policy Server in your deployment.</span>&nbsp;</span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3.&nbsp; Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:1in; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Perform these steps for each Policy Server instance in your deployment.</span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Select Settings&nbsp;&gt; General&nbsp;&gt; SIEM Integration&nbsp;page to configure Websense software to send log data from Filtering Service to a supported Security Information and Event Management (SIEM) solution.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Select Enable SIEM integration for this Policy Server to turn on the SIEM integration feature.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Provide the LEC IP Address or the hostname, as well as the communication Port i.e. 514 to use for sending SIEM data.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Specify the Transport protocol (UDP) to use when sending data to the SIEM product.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Select the SIEM format to use. This determines the syntax of the string used to pass log data to the integration.</span></span></span>\n	<ul>\n		<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Select ArcSight CEF</span></span></span></li>\n	</ul>\n	</li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Click OK to cache your changes. Changes are not implemented until you click Save and Deploy</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Forcepoint</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',5,14,NULL,1,85,NULL),(8,'Log Forwarding Steps','Log forwarding steps for Zscalar version 4.1 and above','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1.&nbsp; Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Version 4.1 and above is supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2.&nbsp; Pre-requisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Admin Privileges to Zscaler</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Subscription to NSS is a must</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3.&nbsp; Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Configure Events to Log</span></strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Login to <strong>the UI. Go to Policy &gt; Administration &gt; Configure Nanolog streaming Service</strong> </span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click on <strong>Edit &gt; Add NSS Feed</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Specify the <strong>name</strong> of the <strong>feed</strong> </span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Specify the IP Address of the LEC. The TCP port should be 514 (syslog port) </span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Set the log output type to Custom and specify the output format given below:&nbsp;</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&quot;zscaler-nss CEF:0|Zscaler|NSSWeblog|4.1|%s{action}|%s{reason}|3|act=%s{action} app=%s{proto} cat=%s{urlcat} dhost=%s{host} dst=%s{sip} src=%s{cip} in=%d{respsize} outcome=%s{respcode} out=%d{reqsize} request=%s{url} rt=%s{mon} %02d{dd} %d{yy} %02d{hh}:%02d{mm}:%02d{ss} sourceTranslatedAddress=%s{cintip} requestClientApplication=%s{ua} requestMethod=%s{reqmethod} suser=%s{login} spriv=%s{location} externalId=%d{recordid} fileType=%s{filetype} reason=%s{reason} destinationServiceName=%s{appname} cn1=%d{riskscore} cn1Label=riskscore cs1=%s{dept} cs1Label=dept cs2=%s{urlsupercat} cs2Label=urlsupercat cs3=%s{appclass} cs3Label=appclass cs4=%s{malwarecat} cs4Label=malwarecat cs5=%s{threatname} cs5Label=threatname cs6=%s{dlpeng} cs6Label=dlpeng ZscalerNSSWeblogURLClass=%s{urlclass} ZscalerNSSWeblogDLPDictionaries=%s{dlpdict} requestContext=%s{referer}\\n&quot;</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4.&nbsp; Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:454.15pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; height:1.0pt; width:63.55pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:1.0pt; width:99.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:1.0pt; width:75.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:1.0pt; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:1.0pt; width:116.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:.65pt; width:63.55pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><strong>Zscaler</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:.65pt; width:99.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:.65pt; width:75.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:.65pt; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:.65pt; width:116.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',6,14,NULL,1,23,NULL),(12,'Log Forwarding Steps','Log forwarding steps for Check Point R77.30 and R80.10','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1.&nbsp; Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Check Point with Gaia Operating System R77.30 and R80.10 are supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2.&nbsp; Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Access to Gaia Portal</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Admin Privilege access</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">For versions R77.30, make sure the Checkpoint LTE add-on is installed</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">For versions R80.10 and below make sure the Checkpoint Log Exporter Tool is installed along with Syslog LTE add-on</span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Arial,sans-serif\"><strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Note:</span></span></strong> </span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Following is the link which can be used for installing the add on <span style=\"color:#0563c1\"><u>https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk105412</u></span>)</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Following is the link which can be used for installing the Checkpoint Log Exporter Tool <span style=\"color:#0563c1\"><u><a href=\"https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk122323\" style=\"color:#0563c1; text-decoration:underline\">https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk122323</a></u></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Make sure to take a Database Revision Control / backup / snapshot of your Check Point machine before installing this Add-on</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">In Management HA environment, this procedure must be performed on both Management Server</span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3.&nbsp; Log Forwarding Steps</strong></span></span></span></p>\n\n<ol start=\"1\" style=\"list-style-type:lower-roman; margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:16pt\"><span style=\"font-family:Arial,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Enable System Logging on Gaia Portal</span></span></strong></span></span></span>\n\n	<ul>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Gaia portal, go to <strong>System Management &gt; System Logging</strong>.</span></span></span></li>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the System Logging section, select the following options:</span></span></span></li>\n	</ul>\n	</li>\n</ol>\n\n<ul style=\"list-style-type:square; margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Send audit logs to management server upon successful configuration</strong></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Send audit logs to syslog upon successful configuration</strong></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Save</strong> your changes before exiting the portal.</span></span></span></li>\n</ul>\n\n<ol start=\"2\" style=\"list-style-type:lower-roman; margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:16pt\"><span style=\"font-family:Arial,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Send Check Point Logs to a Syslog Server</span></span></strong></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To define a syslog server:</span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In <strong>SmartDashboard</strong>, click the <strong>Firewall tab</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Servers and OPSEC Applications object tree, <strong>right-click Servers &gt; New &gt; Syslog</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Syslog Properties window, enter or select values for the following:</span></span></span>\n	<ul>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Name (LEC Server) Host Port (Default = 514) Version (Syslog Protocol)</strong></span></span></span></li>\n	</ul>\n	</li>\n</ul>\n\n<ol start=\"3\" style=\"list-style-type:lower-roman; margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:16pt\"><span style=\"font-family:Arial,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Configure a Gateway to Send Logs to Syslog Servers</span></span></strong></span></span></span></li>\n</ol>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In <strong>SmartDashboard</strong>, go to <strong>Gateway Properties &gt; Logs</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Send logs and alerts to these log servers table, click the <strong>green button to add syslog servers</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Update</strong> policy</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Checkpoint</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n</body>\n</html>\n',10,15,NULL,1,6,NULL),(16,'Log Forwarding Steps','Log forwarding steps for Fortinet 5.0 and 5.2','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Supported OS versions 5.0 and 5.2 &amp; platforms are FGT_1000C,1500D,200D,300C,300D,3600C,3700D,600C, 600D, 60D, 800C, 90D, FGT_VM64 Device.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have SuperAdmin or Admin access to the appliance.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:justify\"><span style=\"font-size:16pt\"><span style=\"font-family:Arial,sans-serif\"><span style=\"color:#c10017\"><strong><u><span style=\"font-size:14.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Using CLI:-</span></span></u></strong></span></span></span></p>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Telnet/SSH to your device.</span></strong></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #config log syslogd setting </span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set status enable </span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set format cef </span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set port (Port Integer)</span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;set server [xxx.xxx.xxx] &lt;- (LEC Server IP address) </span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end</span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #config log syslogd filter </span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;set severity Information</span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;end</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Fortigate FW</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; &ldquo;Fortigate Device&rdquo; to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n</body>\n</html>\n',11,15,NULL,1,26,NULL),(17,'Log forwarding steps','Log forwarding steps for Cisco ASA versions 8.2 to 9.6','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Cisco ASA versions 8.2, 8.3, 8.4, 8.5, 8.6, 9.0, 9.1, 9.2, 9.3, 9.5, and 9.6 are supported.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:18px\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Telnet to your Cisco Machine.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Within the console, enter enable mode by entering <strong>enable</strong> or <strong>en</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter configuration mode by entering <strong>configure terminal</strong> or <strong>conf t</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter the following lines:</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging on</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging timestamp</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# no logging standby</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# no logging console</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# no logging monitor</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# no logging buffered debugging</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging trap debug</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# no logging history</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging facility 22</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging queue 512</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><em><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"color:#002060\">hostname(config)# logging host inside &lt;LEC Server IP Address&gt;</span></span></span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Note: </span></span></strong><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">All the above commands must be executed in global configuration mode.</span></span></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><strong>Source IP</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><strong>Destination IP</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><strong>Protocol</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><strong>Destination Port</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><strong>Direction</strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\">Cisco ASA</span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#262626\">LEC Server</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#262626\">UDP</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#262626\">514</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:left\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Note:</strong> </span></span><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">In case of &ldquo;Cisco Switches/Routers&rdquo; &amp; &ldquo;LEC Server&rdquo; to be integrated are in different networks, above mentioned network port access connectivity shall be required for integration</span></span>.</span></span></span></span></p>\n</body>\n</html>\n',12,15,NULL,1,10,NULL),(18,'Log forwarding steps','Log forwarding steps for PAN OS V 4.0.0 to 6.1','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">PAN-OS version 4.0.0 or higher is supported</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To configure the device to include its IP address in the header of Syslog messages, select <strong>Panorama/Device &gt; Setup &gt; Management</strong>, click the Edit icon in the <strong>Logging and Reporting Settings</strong> section and navigate to the <strong>Log Export and Reporting</strong> tab. In the <strong>Syslog HOSTNAME Format</strong> drop-down select <strong>ipv4-address or ipv6-address</strong>, then click OK.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Device &gt; Server Profiles &gt; Syslog</strong> and click <strong>Add</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter a server profile <strong>Name</strong> and <strong>Location</strong> (location refers to a virtual system, if the device is enabled for virtual systems).</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Servers</strong> tab, click <strong>Add</strong> and enter a <strong>Name</strong>, IP address (<strong>LEC Server</strong> field), <strong>Transport, Port</strong> (default 514 for UDP), and <strong>Facility</strong> (default LOG_USER) for the LEC server.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the <strong>Custom Log Format</strong> tab and click any of the listed log types (Config, System, Threat, Traffic &amp; HIP Match)</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong> twice to save your entries, then click <strong>Commit</strong>.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Palo Alto</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; Palo Alto to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>5. CEF Formats</strong></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:10pt\"><span style=\"font-family:Arial,sans-serif\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Below are the CEF Formats to be used for defining &ldquo;Custom Log Format&rdquo; for the listed log types </span></span><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">(</span></span>Threat, Traffic,&nbsp;<span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Config, Syst</span></span>em, &nbsp;&amp; HIP Match)</span></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Traffic</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|6.1.0|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action flexNumber1Label=Total bytes flexNumber1=$bytes in=$bytes_sent out=$bytes_received cn2Label=Packets cn2=$packets PanOSPacketsReceived=$pkts_received PanOSPacketsSent=$pkts_sent start=$cef-formatted-time_generated cn3Label=Elapsed time in seconds cn3=$elapsed cs2Label=URL Category cs2=$category externalId=$seqno reason=$session_end_reason</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Threat</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|6.1.0|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction externalId=$seqno requestContext=$contenttype cat=$threatid filePath=$cloud fileId=$pcap_id fileHash=$filedigest requestClientApplication=$user_agent fileType=$filetype PanOSXff=$xff PanOSReferer=$referer suid=$sender msg=$subject duid=$recipient oldFileId=$reportid</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Config</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|6.1.0|$result|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial dvchost=$host cs3Label=Virtual System cs3=$vsys act=$cmd duser=$admin destinationServiceName=$client msg=$path externalId=$seqno cs1Label=Before Change Detail cs1=$before-change-detail cs2Label=After Change Detail cs2=$after-change-detail</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">System</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|6.1.0|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial cs3Label=Virtual System cs3=$vsys fname=$object flexString2Label=Module flexString2=$module msg=$opaque externalId=$seqno cat=$eventid</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">HIP Match</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|6.1.0|$matchtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial suser=$srcuser cs3Label=Virtual System cs3=$vsys shost=$machinename src=$src cnt=$repeatcnt externalId=$seqno cat=$matchname cs2Label=Operating System cs2=$os</span></span></p>\n</body>\n</html>\n',18,15,NULL,1,9,NULL),(19,'Log forwarding steps','Log forwarding steps for PAN OS V 7.0','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">PAN-OS version 4.0.0 or higher is supported</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To configure the device to include its IP address in the header of Syslog messages, select <strong>Panorama/Device &gt; Setup &gt; Management</strong>, click the Edit icon in the <strong>Logging and Reporting Settings</strong> section and navigate to the <strong>Log Export and Reporting</strong> tab. In the <strong>Syslog HOSTNAME Format</strong> drop-down select <strong>ipv4-address or ipv6-address</strong>, then click OK.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Device &gt; Server Profiles &gt; Syslog</strong> and click <strong>Add</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter a server profile <strong>Name</strong> and <strong>Location</strong> (location refers to a virtual system, if the device is enabled for virtual systems).</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Servers</strong> tab, click <strong>Add</strong> and enter a <strong>Name</strong>, IP address (<strong>LEC Server</strong> field), <strong>Transport, Port</strong> (default 514 for UDP), and <strong>Facility</strong> (default LOG_USER) for the LEC server.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the <strong>Custom Log Format</strong> tab and click any of the listed log types (Config, System, Threat, Traffic &amp; HIP Match)</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong> twice to save your entries, then click <strong>Commit</strong>.</span></span></span></li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Palo Alto</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; Palo Alto to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>5. CEF Formats</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Below are the CEF Formats to be used for defining &ldquo;Custom Log Format&rdquo; for the listed log types (Threat, Traffic, Config, System, &amp; HIP Match)</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Traffic</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|7.0.0|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action flexNumber1Label=Total bytes flexNumber1=$bytes in=$bytes_sent out=$bytes_received cn2Label=Packets cn2=$packets PanOSPacketsReceived=$pkts_received PanOSPacketsSent=$pkts_sent start=$cef-formatted-time_generated cn3Label=Elapsed time in seconds cn3=$elapsed cs2Label=URL Category cs2=$category externalId=$seqno reason=$session_end_reason PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name cat=$action_source</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Threat</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|7.0.0|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction externalId=$seqno requestContext=$contenttype cat=$threatid filePath=$cloud fileId=$pcap_id fileHash=$filedigest requestClientApplication=$user_agent fileType=$filetype panosxforwarderfor=$xff panosreferer=$referer suid=$sender msg=$subject duid=$recipient oldFileId=$reportid PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Config</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|7.0.0|$result|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial shost=$host cs3Label=Virtual System cs3=$vsys act=$cmd duser=$admin destinationServiceName=$client msg=$path externalId=$seqno PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name cs1Label=Before Change Detail cs1=$before-change-detail cs2Label=After Change Detail cs2=$after-change-detail</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">System</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|7.0.0|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial cs3Label=Virtual System cs3=$vsys fname=$object flexString2Label=Module flexString2=$module msg=$opaque externalId=$seqno cat=$eventid PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">HIP Match</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|7.0.0|$matchtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial suser=$srcuser cs3Label=Virtual System cs3=$vsys shost=$machinename src=$src cnt=$repeatcnt externalId=$seqno cat=$matchname cs2Label=Operating System cs2=$os PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name</span></span></p>\n</body>\n</html>\n',18,15,NULL,1,7,NULL),(20,'Log forwarding steps','Log forwarding steps for PAN OS V 8.0 and higher','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">PAN-OS 8.0 and higher</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To configure the device to include its IP address in the header of Syslog messages, select <strong>Panorama/Device &gt; Setup &gt; Management</strong>, click the Edit icon in the <strong>Logging and Reporting Settings</strong> section and navigate to the <strong>Log Export and Reporting</strong> tab. In the <strong>Syslog HOSTNAME Format</strong> drop-down select <strong>ipv4-address or ipv6-address</strong>, then click OK.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Device &gt; Server Profiles &gt; Syslog</strong> and click <strong>Add</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter a server profile <strong>Name</strong> and <strong>Location</strong> (location refers to a virtual system, if the device is enabled for virtual systems).</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Servers</strong> tab, click <strong>Add</strong> and enter a <strong>Name</strong>, IP address (<strong>LEC Server</strong> field), <strong>Transport, Port</strong> (default 514 for UDP), and <strong>Facility</strong> (default LOG_USER) for the LEC server.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the <strong>Custom Log Format</strong> tab and click any of the listed log types (Config, System, Threat, Traffic, URL, Data, Wildfire, Tunnel, Authentication, User-ID, HIP Match) to define a custom format based on the ArcSight CEF for that log type (see CEF Log Formats attached in the document). On Panorama and on higher-end appliance platforms, such as the PA-3000, PA-5000, PA-5200, and PA-7000 Series, an additional log type (Correlation) is available.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong> twice to save your entries, then click <strong>Commit</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To include User-Agent, Referrer, and X-Forwarder-For values for Threat logs of subtype URL, select Objects -&gt; URL Filtering -&gt; [LEC_created_profile_name] -&gt; URL Filtering Settings and check the three boxes under HTTP Header Logging.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Palo Alto</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; Palo Alto to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n\n<p style=\"margin-left:40px\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>5. CEF Formats</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Below are the CEF Formats to be used for defining &ldquo;Custom Log Format&rdquo; for the listed log types (Traffic, Threat, URL, Data, Wildfire, Config, System, HIP Match,&nbsp;Authentication, User-ID, Tunnel, &amp; Correlation)</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Traffic</span></span></strong></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action flexNumber1Label=Total bytes flexNumber1=$bytes in=$bytes_sent out=$bytes_received cn2Label=Packets cn2=$packets PanOSPacketsReceived=$pkts_received PanOSPacketsSent=$pkts_sent start=$cef-formatted-time_generated cn3Label=Elapsed time in seconds cn3=$elapsed cs2Label=URL Category cs2=$category externalId=$seqno reason=$session_end_reason PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name cat=$action_source PanOSActionFlags=$actionflags PanOSSrcUUID=$src_uuid PanOSDstUUID=$dst_uuid PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time PanOSTunnelType=$tunnel</span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Threat</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction PanOSActionFlags=$actionflags externalId=$seqno cat=$threatid fileId=$pcap_id PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSSrcUUID=$src_uuid PanOSDstUUID=$dst_uuid PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time PanOSTunnelType=$tunnel PanOSThreatCategory=$thr_category PanOSContentVer=$contentver</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">URL</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction PanOSActionFlags=$actionflags externalId=$seqno requestContext=$contenttype cat=$threatid fileId=$pcap_id requestMethod=$http_method requestClientApplication=$user_agent PanOSXForwarderfor=$xff PanOSReferer=$referer PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSSrcUUID=$src_uuid PanOSDstUUID=$dst_uuid PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time PanOSTunnelType=$tunnel PanOSThreatCategory=$thr_category PanOSContentVer=$contentver</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Data</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction PanOSActionFlags=$actionflags externalId=$seqno cat=$threatid fileId=$pcap_id PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSSrcUUID=$src_uuid PanOSDstUUID=$dst_uuid PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time PanOSTunnelType=$tunnel PanOSThreatCategory=$thr_category PanOSContentVer=$contentver</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Wildfire</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=LogProfile cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action request=$misc cs2Label=URL Category cs2=$category flexString2Label=Direction flexString2=$direction PanOSActionFlags=$actionflags externalId=$seqno cat=$threatid filePath=$cloud fileId=$pcap_id fileHash=$filedigest fileType=$filetype suid=$sender msg=$subject duid=$recipient oldFileId=$reportid PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSSrcUUID=$src_uuid PanOSDstUUID=$dst_uuid PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time PanOSTunnelType=$tunnel PanOSThreatCategory=$thr_category PanOSContentVer=$contentver</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Config</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$result|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial shost=$host cs3Label=Virtual System cs3=$vsys act=$cmd duser=$admin destinationServiceName=$client msg=$path externalId=$seqno PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSActionFlags=$actionflags cs1Label=Before Change Detail cs1=$before-change-detail cs2Label=After Change Detail cs2=$after-change-detail</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">System</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|$number-of-severity|rt=$cef-formatted-receive_time deviceExternalId=$serial cs3Label=Virtual System cs3=$vsys fname=$object flexString2Label=Module flexString2=$module msg=$opaque externalId=$seqno cat=$eventid PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSActionFlags=$actionflags</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">HIP Match</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$matchtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial suser=$srcuser cs3Label=Virtual System cs3=$vsys shost=$machinename src=$src cnt=$repeatcnt externalId=$seqno cat=$matchname start=$cef-formatted-time_generated cs2Label=Operating System cs2=$os PanOSActionFlags=$actionflags PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name cn2Label=Virtual System ID cn2=$vsys_id c6a2Label=IPv6 Source Address c6a2=$srcipv6</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Authentication</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial cs1Label=Server Profile cs1=$serverprofile cs2Label=Normalize User cs2=$normalize_user cs3Label=Virtual System cs3=$vsys cs4Label=Authentication Policy cs4=$authpolicy cs5Label=Client Type cs5=$clienttype cs6Label=Log Action cs6=$logset fname=$object cn1Label=Factor Number cn1=$factorno cn2Label=Authentication ID cn2=$authid src=$ip cnt=$repeatcnt duser=$user flexString2Label=Vendor flexString2=$vendor msg=$event externalId=$seqno PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSActionFlags=$actionflags PanOSDesc=$desc</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">User-ID</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial cs1Label=Factor Type cs1=$factortype cs3Label=Virtual System cs3=$vsys cs4Label=Data Source Name cs4=$datasourcename cs5Label=Data Source cs5=$datasource cs6Label=Data Source Type cs6=$datasourcetype cn1Label=Factor Number cn1=$factorno cn2Label=Virtual System ID cn2=$vsys_id cn3Label=Timeout Threshold cn3=$timeout src=$ip spt=$beginport dpt=$endport cnt=$repeatcnt duser=$user externalId=$seqno cat=$eventid end=$factorcompletiontime PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSActionFlags=$actionflags</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Tunnel</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|$sender_sw_version|$subtype|$type|1|rt=$cef-formatted-receive_time deviceExternalId=$serial src=$src dst=$dst sourceTranslatedAddress=$natsrc destinationTranslatedAddress=$natdst cs1Label=Rule cs1=$rule suser=$srcuser duser=$dstuser app=$app cs3Label=Virtual System cs3=$vsys cs4Label=Source Zone cs4=$from cs5Label=Destination Zone cs5=$to deviceInboundInterface=$inbound_if deviceOutboundInterface=$outbound_if cs6Label=Log Action cs6=$logset cn1Label=SessionID cn1=$sessionid cnt=$repeatcnt spt=$sport dpt=$dport sourceTranslatedPort=$natsport destinationTranslatedPort=$natdport flexString1Label=Flags flexString1=$flags proto=$proto act=$action externalId=$seqno PanOSActionFlags=$actionflags PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name PanOSTunnelID=$tunnelid PanOSMonitorTag=$monitortag PanOSParentSessionID=$parent_session_id PanOSParentStartTime=$parent_start_time cs2Label=Tunnel Type cs2=$tunnel flexNumber1Label=Total bytes flexNumber1=$bytes in=$bytes_sent out=$bytes_received cn2Label=Packets cn2=$packets PanOSPacketsSent=$pkts_sent PanOSPacketsReceived=$pkts_received flexNumber2Label=Maximum Encapsulation flexNumber2=$max_encap cfp1Label=Unknown Protocol cfp1=$unknown_proto cfp2Label=Strict Checking cfp2=$strict_check PanOSTunnelFragment=$tunnel_fragment cfp3Label=Sessions Created cfp3=$sessions_created cfp4Label=Sessions Closed cfp4=$sessions_closed reason=$session_end_reason cat=$action_source start=$cef-formatted-time_generated cn3Label=Elapsed time in seconds cn3=$elapsed</span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:14.0pt\"><span style=\"color:#c00000\">Correlation</span></span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">CEF:0|Palo Alto Networks|PAN-OS|8.0|$category|$type|$severity|rt=$cef-formatted-receive_time deviceExternalId=$serial start=$cef-formatted-time_generated src=$src suser=$srcuser cs3Label=Virtual System cs3=$vsys severity=$severity PanOSDGl1=$dg_hier_level_1 PanOSDGl2=$dg_hier_level_2 PanOSDGl3=$dg_hier_level_3 PanOSDGl4=$dg_hier_level_4 PanOSVsysName=$vsys_name dvchost=$device_name cn2Label=Virtual System ID cn2=$vsys_id fname=$object_name cn3Label=Object ID cn3=$object_id msg=$evidence</span></span></p>\n</body>\n</html>\n',18,15,NULL,1,6,NULL),(21,'Start-up Guide - LEC K-POC VM','Start-up Guide - LEC K-POC VM','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c10017\">1.&nbsp;Download LEC virtual appliance binary &amp; Unzip</span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Download LEC binary from URL (link shared through email) and unzip in the file folder. </span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c10017\">2.&nbsp;Launch LEC virtual appliance in a virtualization environment</span></strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Arial&quot;,sans-serif\"><span style=\"color:#c10017\">Option A: In VMware vSphere / ESXi environment</span></span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"color:#c00000\">Navigate to&nbsp; File -&gt; Deploy OVF Template</span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264726002_img1.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264726002_img1.png\" style=\"height:263px; width:396px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><strong>Note</strong>:&nbsp;The current version of vCenter in the example below is version 5.5.</p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\">In the next window, browse the path of LEC&rsquo;s OVA file from the extracted folder.</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264737173_img2.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264737173_img2.png\" style=\"height:306px; width:384px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">The OVF template details will appear in the next window. Click Next</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264746419_img3.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264746419_img3.png\" style=\"height:302px; width:384px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">In the next window, give the virtual machine a name for reference</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264760775_img4.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264760775_img4.png\" style=\"height:302px; width:384px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Select the type of provisioning disk format, recommended &ldquo;Thick Provision Lazy Zeroed&rdquo;</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264772011_img5.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264772011_img5.png\" style=\"height:155px; width:384px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">The next menu will summarize the options to apply for the deployment of the appliance.</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264782076_img6.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264782076_img6.png\" style=\"height:303px; width:384px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Once&nbsp;Finish&nbsp;is selected, a window will appear and provide the status of the deployment.</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264791945_img7.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264791945_img7.png\" style=\"height:132px; width:583px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Once complete, a window will appear and show that the deployment completed successfully.</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264803193_img8.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264803193_img8.png\" style=\"height:115px; width:375px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#c00000\">Follow Step 3 and update IP address, then VM will be ready and we are good to go.</span></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Arial&quot;,sans-serif\"><span style=\"color:#c10017\">Option B: Importing an Existing Virtual Machine into VirtualBox</span></span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Note: <a href=\"https://www.virtualbox.org/wiki/Downloads\"><span style=\"color:#0070c0\">Click here</span></a> to download VM player, if there is no pre VM environment. </span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Navigate to File &ndash; &gt; Import Appliance</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Click&nbsp;<strong>Choose</strong>, browse to the location containing the *.ovf or *.ova file of the virtual machine you want to import and click&nbsp;<strong>Open</strong>. </span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264816582_img9.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264816582_img9.png\" style=\"height:264px; width:384px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264828439_img10.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264828439_img10.png\" style=\"height:292px; width:384px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#c00000\">Appliance Import Settings</span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264852009_img12.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264852009_img12.png\" style=\"height:292px; width:384px\" /></span></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Make any adjustments you want to the displayed settings (you can also change the settings later) and click&nbsp;Import. The Appliance Import Wizard is closed and after a few moments, the imported virtual machine is listed in Oracle VM VirtualBox Manager.</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">After the import, select the imported virtual machine and in the toolbar click the&nbsp;Settings&nbsp;button. Review the virtual machine settings to make sure that the virtual machine has the hardware it needs to operate. Make sure that the virtual machine has a CD/DVD drive.</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Once you have reviewed the settings, select the imported virtual machine and in the toolbar click the&nbsp;Start&nbsp;button. Verify that the virtual machine works.</span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Follow Step 3 and update IP&nbsp;address, then VM will be ready and we are good to go</span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:16px\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Arial&quot;,sans-serif\"><span style=\"color:#c10017\">Option C: Launching VM using VM Ware Player.</span></span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Note</span>: <a href=\"https://www.vmware.com/in/products/workstation-player/workstation-player-evaluation.html\"><span style=\"color:#0070c0\">Click here</span></a> <span style=\"color:#c00000\">to download VM player, if there is no pre VM environment.</span> </span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#c00000\">Steps to Open VM using VM player.</span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Select &ldquo;Open a Virtual Machine&rdquo;</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264862901_img13.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264862901_img13.png\" style=\"height:256px; width:428px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Navigate to VM file &ldquo;.*.vm&ccedil;*.vmc;*.ovf;*.ova&rdquo; and select VM &ldquo;LEC&quot;</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264874648_img14.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264874648_img14.png\" style=\"height:352px; width:434px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">The right-hand side of VMWare selected VM will be reflected choose VM and click on Play virtual machine.</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"color:#c00000\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264886098_img15.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264886098_img15.png\" style=\"height:263px; width:480px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Follow Step 3 and update IP address, then VM will be ready and we are good to go</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c10017\">3.&nbsp;Ip address configuration CentOS</span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c00000\">Login Credential to login into VM&nbsp;</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>User name</strong>: lecuser</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Password</strong>:&nbsp;!3cvm2018</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Type &ldquo;nmcli d&rdquo; command in your terminal for quick list&nbsp;ethernet card&nbsp;installed on your machine, and note down device name to perform update/edit of the device</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264896652_img16.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264896652_img16.png\" style=\"height:223px; width:453px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Type &ldquo;nmtui&rdquo; command in your terminal to open&nbsp;Network manager. After opening Network manager choose&nbsp;&ldquo;Edit connection&rdquo; and press Enter (Use TAB button for choosing options).</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264907317_img17.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264907317_img17.png\" style=\"height:261px; width:332px\" /></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\">Post to that navigate to proper device name which needs to edit, then update IP address, gateway, DNS servers as per the organization configuration or IP allocated to below VM.</span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264920613_img18.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549264920613_img18.png\" style=\"height:224px; width:384px\" /><br />\n<span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Once Ip address updated click &ldquo;OK&rdquo; to exit window then type </span></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">systemctl restart network.service&rdquo; on the terminal window to restart the network service, then you will be ready to go with the updated IP address.</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:red\">Note</span></strong>:</span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Once IP address configured check internet connection status, if the network is connected without any error we are good to go.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;If Organization is using Hyper &ndash; V environment please contact us back for getting VHD file and steps to import VHD into Hyper &ndash; V</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c10017\">Port Access Matrix</span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:black\">LEC Access </span></strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">As per below matrix the ports should be open for connecting to the LEC Server</span></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:undefined\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:103.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:white\">Source</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:110.6pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:white\">Destination</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:white\">Protocol</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:79.7pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:white\">Port</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:72.35pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:white\">Connection</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:103.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"width:110.6pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">35.168.158.169</span></span></span></p>\n			</td>\n			<td style=\"width:85.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">UDP</span></span></span></span></p>\n			</td>\n			<td style=\"width:79.7pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">1194</span></span></span></span></p>\n			</td>\n			<td style=\"width:72.35pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">Stateful Connection</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:103.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"width:110.6pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">35.168.158.169</span></span></span></p>\n			</td>\n			<td style=\"width:85.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">UDP</span></span></span></span></p>\n			</td>\n			<td style=\"width:79.7pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">1197</span></span></span></span></p>\n			</td>\n			<td style=\"width:72.35pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">Stateful Connection</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:103.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">LEC Server (On-Prem)</span></span></span></p>\n\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">{<span style=\"color:black\">Log Forwarding to MDR cloud}</span></span></span></p>\n			</td>\n			<td style=\"width:110.6pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Paladion Cloud Platform (104.42.251.132)</span></span></span></p>\n			</td>\n			<td style=\"width:85.15pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">TCP</span></span></span></p>\n			</td>\n			<td style=\"width:79.7pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">443</span></span></span></p>\n			</td>\n			<td style=\"width:72.35pt\">\n			<p style=\"margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">Stateful Connection</span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:40px; margin-right:0in\">&nbsp;</p>\n</body>\n</html>\n',13,17,NULL,1,23,NULL),(22,'Log forwarding steps','Log forwarding steps for Microsoft Windows and Server','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Microsoft Windows Server 2008 R2 &amp; above, Microsoft Windows 7 &amp; above</span></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Windows Hosts Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">.NET 4.5, 4.5.2, 4.6, or 4.6.1</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Minimum PowerShell version is 5 and PowerShell remoting needs to be enabled</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Create a Read Only Domain User (username can be &ldquo;arcsight&rdquo;)</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Add the Domain User to <strong>&ldquo;Event Log Reader&rdquo;</strong> &amp; <strong>&ldquo;Windows Remote Management Users&rdquo;</strong> Group</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Enable windows auditing policy as per &ldquo;<strong>Logging Guidelines</strong>&rdquo; provided below</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Use the below providied&nbsp; to Invoke (Execute) permissions to Windows Remote Users Group on the respective windows servers and Configure WinRM HTTP &amp; HTTPS listeners on the windows servers</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><strong><u><span style=\"font-size:10pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Script</span></span></span></span></u></strong></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Pal-MDR Windows Log forwarding enabling script</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">[CmdletBinding()]</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Param (<br />\n&nbsp; &nbsp; [string]$SubjectName = $env:COMPUTERNAME,<br />\n&nbsp; &nbsp; [int]$CertValidityDays = 1095,<br />\n&nbsp; &nbsp; [switch]$SkipNetworkProfileCheck,<br />\n&nbsp; &nbsp; $CreateSelfSignedCert = $true,<br />\n&nbsp; &nbsp; [switch]$ForceNewSSLCert,<br />\n&nbsp; &nbsp; [switch]$GlobalHttpFirewallAccess,<br />\n&nbsp; &nbsp; [switch]$DisableBasicAuth = $false,<br />\n&nbsp; &nbsp; [switch]$EnableCredSSP<br />\n)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Function Write-Log<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-EventLog -LogName Application -Source $EventSource -EntryType Information -EventId 1 -Message $Message<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Function Write-VerboseLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Verbose $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Function Write-HostLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Output $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Function New-LegacySelfSignedCert<br />\n{<br />\n&nbsp; &nbsp; Param (<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [string]$SubjectName,<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [int]$ValidDays = 1095<br />\n&nbsp; &nbsp; )</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $hostnonFQDN = $env:computerName&nbsp;<br />\n&nbsp; &nbsp; $hostFQDN = [System.Net.Dns]::GetHostByName(($env:computerName)).Hostname<br />\n&nbsp; &nbsp; $SignatureAlgorithm = &quot;SHA256&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $name = New-Object -COM &quot;X509Enrollment.CX500DistinguishedName.1&quot;<br />\n&nbsp; &nbsp; $name.Encode(&quot;CN=$SubjectName&quot;, 0)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $key = New-Object -COM &quot;X509Enrollment.CX509PrivateKey.1&quot;<br />\n&nbsp; &nbsp; $key.ProviderName = &quot;Microsoft Enhanced RSA and AES Cryptographic Provider&quot;<br />\n&nbsp; &nbsp; $key.KeySpec = 1<br />\n&nbsp; &nbsp; $key.Length = 3072<br />\n&nbsp; &nbsp; $key.SecurityDescriptor = &quot;D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)&quot;<br />\n&nbsp; &nbsp; $key.MachineContext = 1<br />\n&nbsp; &nbsp; $key.ExportPolicy = 1<br />\n&nbsp; &nbsp; $key.Create()</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $serverauthoid = New-Object -COM &quot;X509Enrollment.CObjectId.1&quot;<br />\n&nbsp; &nbsp; $serverauthoid.InitializeFromValue(&quot;1.3.6.1.5.5.7.3.1&quot;)<br />\n&nbsp; &nbsp; $ekuoids = New-Object -COM &quot;X509Enrollment.CObjectIds.1&quot;<br />\n&nbsp; &nbsp; $ekuoids.Add($serverauthoid)<br />\n&nbsp; &nbsp; $ekuext = New-Object -COM &quot;X509Enrollment.CX509ExtensionEnhancedKeyUsage.1&quot;<br />\n&nbsp; &nbsp; $ekuext.InitializeEncode($ekuoids)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $cert = New-Object -COM &quot;X509Enrollment.CX509CertificateRequestCertificate.1&quot;<br />\n&nbsp; &nbsp; $cert.InitializeFromPrivateKey(2, $key, &quot;&quot;)<br />\n&nbsp; &nbsp; $cert.Subject = $name<br />\n&nbsp; &nbsp; $cert.Issuer = $cert.Subject<br />\n&nbsp; &nbsp; $cert.NotBefore = (Get-Date).AddDays(-1)<br />\n&nbsp; &nbsp; $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $SigOID = New-Object -ComObject X509Enrollment.CObjectId<br />\n&nbsp; &nbsp; $SigOID.InitializeFromValue(([Security.Cryptography.Oid]$SignatureAlgorithm).Value)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; [string[]] $AlternativeName &nbsp;+= $hostnonFQDN<br />\n&nbsp; &nbsp; $AlternativeName += $hostFQDN<br />\n&nbsp; &nbsp; $IAlternativeNames = New-Object -ComObject X509Enrollment.CAlternativeNames</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; foreach ($AN in $AlternativeName)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName = New-Object -ComObject X509Enrollment.CAlternativeName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName.InitializeFromString(0x3,$AN)<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $IAlternativeNames.Add($AltName)<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $SubjectAlternativeName = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames<br />\n&nbsp; &nbsp; $SubjectAlternativeName.InitializeEncode($IAlternativeNames)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; [String[]]$KeyUsage = (&quot;DigitalSignature&quot;, &quot;KeyEncipherment&quot;)<br />\n&nbsp; &nbsp; $KeyUsageObj = New-Object -ComObject X509Enrollment.CX509ExtensionKeyUsage<br />\n&nbsp; &nbsp; $KeyUsageObj.InitializeEncode([int][Security.Cryptography.X509Certificates.X509KeyUsageFlags]($KeyUsage))<br />\n&nbsp; &nbsp; $KeyUsageObj.Critical = $true</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $cert.X509Extensions.Add($KeyUsageObj)<br />\n&nbsp; &nbsp; $cert.X509Extensions.Add($ekuext)<br />\n&nbsp; &nbsp; $cert.SignatureInformation.HashAlgorithm = $SigOID<br />\n&nbsp; &nbsp; $CERT.X509Extensions.Add($SubjectAlternativeName)<br />\n&nbsp; &nbsp; $cert.Encode()</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $enrollment = New-Object -COM &quot;X509Enrollment.CX509Enrollment.1&quot;<br />\n&nbsp; &nbsp; $enrollment.InitializeFromRequest($cert)<br />\n&nbsp; &nbsp; $certdata = $enrollment.CreateRequest(0)<br />\n&nbsp; &nbsp; $enrollment.InstallResponse(2, $certdata, 0, &quot;&quot;)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; # extract/return the thumbprint from the generated cert<br />\n&nbsp; &nbsp; $parsed_cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2<br />\n&nbsp; &nbsp; $parsed_cert.Import([System.Text.Encoding]::UTF8.GetBytes($certdata))</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; return $parsed_cert.Thumbprint<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Function Enable-GlobalHttpFirewallAccess<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Forcing global HTTP firewall access&quot;<br />\n&nbsp; &nbsp; # this is a fairly naive implementation; could be more sophisticated about rule matching/collapsing<br />\n&nbsp; &nbsp; $fw = New-Object -ComObject HNetCfg.FWPolicy2</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; # try to find/enable the default rule first<br />\n&nbsp; &nbsp; $add_rule = $false<br />\n&nbsp; &nbsp; $matching_rules = $fw.Rules | ? { $_.Name -eq &quot;Windows Remote Management (HTTP-In)&quot; }<br />\n&nbsp; &nbsp; $rule = $null<br />\n&nbsp; &nbsp; If ($matching_rules) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; If ($matching_rules -isnot [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing existing single HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Else {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # try to find one with the All or Public profile first<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Found multiple existing HTTP firewall rules...&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules | % { $_.Profiles -band 4 }[0]</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (-not $rule -or $rule -is [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing an arbitrary single HTTP firewall rule (multiple existed)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # oh well, just pick the first one<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules[0]<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; If (-not $rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Creating a new HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule = New-Object -ComObject HNetCfg.FWRule<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Name = &quot;Windows Remote Management (HTTP-In)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Description = &quot;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $add_rule = $true<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $rule.Profiles = 0x7FFFFFFF<br />\n&nbsp; &nbsp; $rule.Protocol = 6<br />\n&nbsp; &nbsp; $rule.LocalPorts = 5985<br />\n&nbsp; &nbsp; $rule.RemotePorts = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.LocalAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.RemoteAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.Enabled = $true<br />\n&nbsp; &nbsp; $rule.Direction = 1<br />\n&nbsp; &nbsp; $rule.Action = 1<br />\n&nbsp; &nbsp; $rule.Grouping = &quot;Windows Remote Management&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; If ($add_rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $fw.Rules.Add($rule)<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;HTTP firewall rule $($rule.Name) updated&quot;<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Setup error handling.<br />\nTrap<br />\n{<br />\n&nbsp; &nbsp; $_<br />\n&nbsp; &nbsp; Exit 1<br />\n}<br />\n$ErrorActionPreference = &quot;Stop&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Get the ID and security principal of the current user account<br />\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Get the security principal for the Administrator role<br />\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Check to see if we are currently running &quot;as Administrator&quot;<br />\nif (-Not $myWindowsPrincipal.IsInRole($adminRole))<br />\n{<br />\n&nbsp; &nbsp; Write-Output &quot;ERROR: You need elevated Administrator privileges in order to run this script.&quot;<br />\n&nbsp; &nbsp; Write-Output &quot; &nbsp; &nbsp; &nbsp; Start Windows PowerShell by using the Run as Administrator option.&quot;<br />\n&nbsp; &nbsp; Exit 2<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">$EventSource = $MyInvocation.MyCommand.Name<br />\nIf (-Not $EventSource)<br />\n{<br />\n&nbsp; &nbsp; $EventSource = &quot;Powershell CLI&quot;<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If ([System.Diagnostics.EventLog]::Exists(&#39;Application&#39;) -eq $False -or [System.Diagnostics.EventLog]::SourceExists($EventSource) -eq $False)</span><br />\n<u><span style=\"color:black\">{</span></u><br />\n<span style=\"color:black\">&nbsp; &nbsp; New-EventLog -LogName Application -Source $EventSource<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Detect PowerShell version.<br />\nIf ($PSVersionTable.PSVersion.Major -lt 3)<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:PowerShell version 3 or higher is required.&quot;<br />\n&nbsp; &nbsp; Throw &quot;PowerShell version 3 or higher is required.&quot;<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Find and start the WinRM service.<br />\nWrite-Verbose &quot;Verifying WinRM service.&quot;<br />\nIf (!(Get-Service &quot;WinRM&quot;))<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to find the WinRM service.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to find the WinRM service.&quot;<br />\n}<br />\nElseIf ((Get-Service &quot;WinRM&quot;).Status -ne &quot;Running&quot;)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Setting WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Set-Service -Name &quot;WinRM&quot; -StartupType Automatic<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Set WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Write-Verbose &quot;Starting WinRM service.&quot;<br />\n&nbsp; &nbsp; Start-Service -Name &quot;WinRM&quot; -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Started WinRM service.&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># WinRM should be running; check that we have a PS session config.<br />\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))<br />\n{<br />\n&nbsp; If ($SkipNetworkProfileCheck) {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting without checking Network profile.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting without checking Network profile.&quot;<br />\n&nbsp; }<br />\n&nbsp; Else {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting.&quot;<br />\n&nbsp; }<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;PS Remoting is already enabled.&quot;<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Make sure there is a SSL listener.<br />\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener<br />\nIf (!($listeners | Where {$_.Keys -like &quot;TRANSPORT=HTTPS&quot;}))<br />\n{<br />\n&nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; # Create the hashtables of settings to be used.<br />\n&nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;Enabling SSL listener.&quot;<br />\n&nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled SSL listener.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;SSL listener is already active.&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; # Force a new SSL cert on Listener if the $ForceNewSSLCert<br />\n&nbsp; &nbsp; If ($ForceNewSSLCert)<br />\n&nbsp; &nbsp; {</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Delete the listener for SSL<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Remove-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Add new Listener with new SSL cert<br />\n&nbsp; &nbsp; &nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Check for basic authentication.<br />\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where-Object {$_.Name -eq &quot;Basic&quot;}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If ($DisableBasicAuth)&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $true)&nbsp;<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Disabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $false<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Disabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already disabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}&nbsp;<br />\nElse&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $true<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Enabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already enabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># If EnableCredSSP if set to true<br />\nIf ($EnableCredSSP)<br />\n{<br />\n&nbsp; &nbsp; # Check for CredSSP authentication<br />\n&nbsp; &nbsp; $credsspAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq &quot;CredSSP&quot;}<br />\n&nbsp; &nbsp; If (($credsspAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Enable-WSManCredSSP -role server -Force<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If ($GlobalHttpFirewallAccess) {<br />\n&nbsp; &nbsp; Enable-GlobalHttpFirewallAccess<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Configure firewall to allow WinRM HTTPS connections.<br />\n$fwtest1 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot;<br />\n$fwtest2 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot; profile=any<br />\nIf ($fwtest1.count -lt 5)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Adding firewall rule to allow WinRM HTTPS.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall add rule profile=any name=&quot;Allow WinRM HTTPS&quot; dir=in localport=5986 protocol=TCP action=allow</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp; &nbsp; Write-Log &quot;Added firewall rule to allow WinRM HTTPS.&quot;<br />\n}<br />\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Updating firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall set rule name=&quot;Allow WinRM HTTPS&quot; new profile=any<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Updated firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Firewall rule already exists to allow WinRM HTTPS.&quot;<br />\n}</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"># Test a remoting connection to localhost, which should work.<br />\n$httpResult = Invoke-Command -ComputerName &quot;localhost&quot; -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue<br />\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">$httpsResult = New-PSSession -UseSSL -ComputerName &quot;localhost&quot; -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue</span></span></span></p>\n\n<p style=\"margin-left:200px\"><span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If ($httpResult -and $httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpsResult -and !$httpResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Disabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpResult -and !$httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Disabled&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n}<br />\nWrite-VerboseLog &quot;Pal-MDR:PS Remoting has been successfully configured.&quot;</span></span></span><br />\n<span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">netsh advfirewall firewall add rule profile=any name=&quot;Allow NetBIOS&quot; dir=in localport=135 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow NetBIOS(135).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow WinC&quot; dir=in localport=49153 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow WinC(49153).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow MessageQueue &quot; dir=out localport=61616 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow Outbound MessageQueue(61616).&quot;</span></span></span><br />\n<span style=\"font-size:10px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">winrm s winrm/config/service &#39;@{RootSDDL=&quot;O:NSG:BAD:P(A;;GX;;;S-1-5-21-3438187023-432945961-1320742929-1000)(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;}&#39;</span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:10pt\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Run it from a PowerShell prompt (In Administrative Mode). If the script is successful, an HTTPS listener will be created for the WinRM service.</span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>NOTE: </strong>Before executing the script, make sure to replace with the SID of the domain user created<strong> </strong>at the end of the script<strong>.</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><img alt=\"\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" style=\"height:24px; width:800px\" /></strong></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Additional Configurations</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"color:black\">Navigate to Local Group policy &gt; Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Configuration &gt; Detailed Tracking. Enable</span> <span style=\"color:black\">auditing of &ldquo;Include command line in process creation event&rdquo;. (Refer screenshot below)</span> </strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong><span style=\"color:black\"><img alt=\"\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625556431_windows2.png\" style=\"height:457px; width:500px\" /></span></strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#0070c0\"><strong><span style=\"color:black\">To ensure that Advanced Audit Policy Configuration settings are not overwritten</span></strong></span></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">Open the Group Policy Management console</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Right-click Default Domain Policy, and then click Edit.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Double-click Computer Configuration, double-click Policies, and then double-click Windows Settings.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Double-click Security Settings, double-click Local Policies, and then click Security Options.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Double-click Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings, and then click Define this policy setting.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click Enabled, and then click OK.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><img alt=\"\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625568718_windows3.png\" style=\"height:250px; width:500px\" /></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>5. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:516.8pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Windows Servers</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">49153</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Windows Servers</span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">135</span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Windows Servers</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">5985</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Windows Servers</span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">5986</span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Windows Servers</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">61616</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;Log Collector Server&rdquo; &amp; Windows Server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>6. Logging Guidelines</strong></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Note:</strong> The below mentioned logging guidelines are based on best practices for security monitoring. However, keep in mind that auditing events consumes system resources such as memory, processing power, and disk space. The more events you audit, the more of these resources are consumed. Auditing an excessive number of events can dramatically slow down your servers.</span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><img alt=\"\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625579706_windows4.png\" style=\"height:361px; width:500px\" /></span></span></p>\n</body>\n</html>\n',19,16,NULL,1,30,NULL),(23,'Log forwarding steps','Log forwarding steps for Blue Coat Proxy SG Series, versions 6.3, 6.5, and 6.6','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Blue Coat Proxy SG Series supports versions 6.3, 6.5, and 6.6</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><strong><span style=\"font-size:14.0pt\">2. Log Forwarding Steps</span></strong></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Configure which Events to Log</span></strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To set the event logging level using the Management Console:</span></span></span></p>\n\n<ol>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Maintenance -&gt; Event Logging -&gt; Level</strong>. The Level pane is displayed</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the level <strong>Informational</strong> to log</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Apply</strong></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Set Event Log Size </span></strong></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To set the event log size using the Management Console: </span></span></span></p>\n\n<ol>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Maintenance -&gt; Event Logging -&gt; Size</strong></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Event log size</strong> field, enter <strong>50 Mb</strong> size of the event log </span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select either<strong> Overwrite earlier events</strong> to specify the desired behavior when the event log reaches maximum size</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Apply</strong></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Monitor Syslog Events</span></strong></span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To enable syslog monitoring using the Management Console: </span></span></span></p>\n\n<ol start=\"1\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Maintenance -&gt; Event Logging -&gt; Syslog</strong></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Loghost</strong> field, enter the <strong>domain name or IP addres</strong>s of the <strong>LEC Server</strong> </span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>Enable</strong> Syslog</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Apply</strong>.</span></span></span></li>\n</ol>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Blue Coat Proxy SG</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',20,14,NULL,1,NULL,NULL),(24,'Log forwarding steps','Log forwarding steps for Red Hat Linux Enterprise , Versions 6.7, 7.0, 7.1, 7.2, 7.3, and 7.4','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">Red Hat Linux Enterprise 6.7, 7.0, 7.1, 7.2, 7.3, and 7.4</span></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">Should have root privileges.</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">Rsyslog should be installed and running. </span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><strong><span style=\"font-size:14.0pt\">3. Log Forwarding Steps</span></strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align: justify;\"><span style=\"display:none\">&nbsp;</span><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Edit the /etc/rsyslog.conf file and make the following entry at the end of the file to enable logging:-</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:120px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">*.* @log event collector (LEC)</span></span></span></p>\n\n<p style=\"margin-left:120px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">E.g.:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @10.10.10.1</span></span></span></p>\n\n<ul>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Restart the rsyslog service:</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:120px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">#Systemctl restart rsyslog (RHEL 7 &amp; above) </span></span></span></p>\n\n<p style=\"margin-left:120px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Or </span></span></span></p>\n\n<p style=\"margin-left:120px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">#Service rsyslog restart (below RHEL 7)</span></span></span><span style=\"display:none\">&nbsp;</span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:515.55pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; height:28.4pt; width:111.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:28.4pt; width:111.0pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:28.4pt; width:63.45pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:28.4pt; width:95.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:28.4pt; width:134.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:14.2pt; width:111.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Linux Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:14.2pt; width:111.0pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:14.2pt; width:63.45pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:14.2pt; width:95.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:14.2pt; width:134.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;Log Collector Server&rdquo; &amp; Linux server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration</span></span></span></p>\n</body>\n</html>\n',21,16,NULL,1,3,NULL),(25,'Log forwarding steps','Log forwarding steps for Aruba versions 6.3 and 6.4 ','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></p>\n\n<p style=\"margin-left:80px; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Aruba versions 6.3 and 6.4 are supported.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"color:#c10017\"><strong>2. Prerequisite</strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">Login through Admin account</span></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">&nbsp;Configure through Web UI:-</span></span></span></p>\n\n<ul>\n	<li style=\"text-align: left; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><strong><span style=\"color:black\">Navigate to the Configuration -&gt; Management -&gt; Logging page</span></strong></span></span></span></li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To add a logging server, click <strong>Add</strong> in the Logging Servers section</span></span></span></li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Add</strong> to add the logging server to the list of logging servers. Ensure that the syslog server is enabled and configured on this host</span></span></span></li>\n	<li style=\"text-align: left; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><strong><span style=\"color:black\">Select the module or modules you want to log. From the drop-down list displayed, select the appropriate logging level. Click Done to configure the logging level</span></strong></span></span></span></li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Apply</strong> to apply the configuration</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c10017\">4. Connectivity Requirements</span></strong></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:white\">Source IP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:white\">Destination IP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:white\">Protocol</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:white\">Destination Port</span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:white\">Direction</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Aruba Wireless Controller</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12px\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;<strong>Aruba Wireless Controller</strong>&rdquo; &amp; &ldquo;LEC Server&rdquo; to be integrated are in different networks, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n</body>\n</html>\n',22,18,NULL,1,4,NULL),(27,'Log forwarding steps','Log forwarding steps for Cisco Catalyst Switch devices using CatOS versions 5.0 and 8.0 ','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Cisco Catalyst Switch devices using CatOS versions 5.0 and 8.0 are supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Configure Syslog Servers</span></strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">To configure the switch to log messages to a syslog server, perform this task in privileged mode:</span></span></p>\n\n<ol>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Add a syslog server to the configuration</span></span>\n\n	<ul>\n		<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><em><span style=\"color:#002060\">set logging server &lt;LEC Server IP address or hostname&gt;</span></em></span></span></li>\n	</ul>\n	</li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Enable system message logging to configured syslog servers</span></span>\n	<ul>\n		<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><em><span style=\"color:#002060\">set logging server enable</span></em></span></span></li>\n	</ul>\n	</li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Set the facility and severity level for syslog server messages</span></span>\n	<ul>\n		<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><em><span style=\"color:#002060\">set logging server facility local0</span></em></span></span></li>\n		<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><em><span style=\"color:#002060\">set logging server severity Informational</span></em></span></span></li>\n	</ul>\n	</li>\n	<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Disable system message logging to the console <strong>(Optional)</strong> </span></span>\n	<ul>\n		<li style=\"text-align: justify; margin-left: 40px;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><em><span style=\"color:#002060\">set logging console disable</span></em></span></span></li>\n	</ul>\n	</li>\n</ol>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><strong><span style=\"font-size:14.0pt\">3. <span style=\"font-size:18px\">Connectivity Requirements</span></span></strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#ffffff\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Cisco Catalyst Switch</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',26,18,NULL,1,3,NULL),(28,'Log forwarding steps','Log forwarding steps for Cisco Wireless LAN Controller software version 7.1, 7.6 and 8.2 and AireSpace WLAN controller logs','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Cisco Wireless LAN Controller software version 7.1, 7.6 and 8.2 and AireSpace WLAN controller logs.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In order to configure the WLC for syslog servers with the GUI, complete these steps from the Wireless LAN Controller GUI</span></span></span></p>\n\n<ul>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Choose&nbsp;<strong>MANAGEMENT</strong> &gt; <strong>Logs</strong> &gt; <strong>Config</strong>&nbsp;to navigate to this page.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter the <strong>LEC server IP</strong> address and click&nbsp;<strong>Add</strong>.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Under&nbsp;<strong>Syslog Level</strong>, set the severity level to <strong>level6 (Informational)</strong></span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Under&nbsp;<strong>Syslog Facility</strong>, set the facility level to <strong>Syslog=Facility level 5</strong></span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click&nbsp;A<strong>pply</strong></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>WLC</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',26,18,NULL,1,2,NULL),(30,'Log forwarding steps','Log forwarding steps for Citrix NetScaler versions 10.0, 10.1, 10.5, and 11.0','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\"><span style=\"font-size:11.0pt\"><span style=\"font-size:12px\">Citrix NetScaler versions 10.0, 10.1, 10.5, and 11.0 are supported</span>.</span></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To configure NetScaler to collect syslog events: </span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Login</strong> to Citrix NetScaler.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">From the <strong>left pane</strong>, select <strong>System and Auditing.</strong> Click <strong>Change global auditing settings</strong></span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select <strong>SYSLOG</strong> as the <strong>Auditing Type</strong> and add the <strong>IP address</strong> and <strong>port number</strong> of the LEC server under <strong>Server</strong>. Select <strong>ALL log levels except Debug</strong>. Select <strong>Log Facility=Local0</strong></span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">The date format must be <strong>MMDDYYYY</strong> to be parsed correctly.</span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong> to save your configuration and close the Configure Auditing Parameters window. </span></span></span></li>\n	<li><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Save</strong> to save running configuration.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Citrix NetScaler</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',27,20,NULL,1,1,NULL),(31,'Log forwarding steps','Log forwarding steps for Dell - Sonic OS 5.8 and 6.2','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Dell - Sonic OS 5.8 and 6.2 are supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>Configure the SonicWALL device (SonicOS 6.2) to send syslog events as follows:</strong></span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Login</strong> to the SonicWALL management interface with the admin account.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Go to <strong>Log</strong> &gt; <strong>Syslog</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the <strong>Syslog Servers</strong> section, click <strong>Add</strong>. </span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the <strong>LEC</strong> <strong>server name or IP address</strong> from the Name or IP Address drop-down menu.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Messages from the firewall are then sent to the servers.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If your syslog server does not use default port 514, type another port number in the Port Number field.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>OK</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Accept</strong> to save all Syslog Server settings.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>Configure the SonicWALL device (SonicOS 5.8) to send syslog events as follows:</strong></span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Login to the SonicWALL management interface with the <strong>admin</strong> account.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Log</strong> on the left side of the browser window; then click the <strong>Log Settings </strong>tab.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Syslog Servers section, enter the <strong>syslog</strong> <strong>server name or IP address</strong> in the <strong>Add Syslog Server</strong> field. </span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><img alt=\"\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1550128402267_dell.png\" style=\"height:246px; width:300px\" /></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Automation section, select how often the log is to be sent and what to do upon overflow<strong>. Set the Syslog Individual Event Rate</strong> as 120 seconds. Choose the format of the Syslog to be <strong>Default.</strong></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click on <strong>Update</strong> to <strong>save</strong> your settings</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Dell SonicWall</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n</body>\n</html>\n',28,21,NULL,1,NULL,NULL),(32,'Log forwarding steps','Log forwarding steps for F5 Networks, versions 10.2, 11, 11.4, 11.6. 12.0, and 12.1 / Access Policy Module (APM) v11.3 is also supported','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">F5 Traffic Management Operations System (TMOS) versions 10.2, 11, 11.4, 11.6. 12.0, and 12.1 are supported. Access Policy Module (APM) v11.3 is also supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><strong><span style=\"font-size:14.0pt\">2. Prerequisites</span></strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For correct parsing of BIG-IP version 11.6 TMOS events, go to <span style=\"color:#0070c0\"><u><a href=\"https://downloads.f5.com/esd/product.jsp?sw=BIG-IP&amp;pro=big-ip_v11.x\" style=\"color:#0070c0; text-decoration:underline\">https://downloads.f5.com/esd/product.jsp?sw=BIG-IP&amp;pro=big-ip_v11.x</a></u></span>, log in to the F5 site, and download and install F5&#39;s Hotfix-BIGIP-11.6.0.4.0.420-HF4.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Configuring Big-IP</span></span></span>\n\n	<ol style=\"list-style-type:upper-roman\">\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">To add a single remote syslog server:</span></strong></span></span></span></li>\n	</ol>\n\n	<ul style=\"margin-left:40px\">\n		<li style=\"text-align: justify;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter the following command to log into the Traffic Management Shell.</span></span></span></li>\n	</ul>\n	</li>\n</ul>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">tmsh</span></em></span></span></span></p>\n\n<ol>\n	<li style=\"list-style-type:none\">\n	<ol>\n		<li style=\"list-style-type:none\">&nbsp;</li>\n	</ol>\n	</li>\n</ol>\n\n<ul style=\"list-style-type:circle; margin-left:120px\">\n	<li style=\"text-align: justify;\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Add the server using the following command syntax:</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">modify /sys syslog remote-servers add { &lt;name&gt; { host &lt;IP_address&gt; remote-port &lt;port&gt; } }</span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For example, to add remote syslog server <strong>xx.xx.xx.xx</strong> on port <strong>514</strong> and name <strong>mysyslog</strong>, enter the following command:</span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">modify /sys syslog remote-servers add { <strong>mysyslog</strong> { host <strong>172.28.31.40</strong> remote-port <strong>514</strong> } }</span></span></span></p>\n\n<ol>\n	<li style=\"list-style-type:none\">\n	<ol>\n		<li style=\"list-style-type:none\">\n		<ul style=\"list-style-type:circle; margin-left:40px\">\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To save the configuration, enter the following command:</span></span></span></li>\n		</ul>\n		</li>\n	</ol>\n	</li>\n</ol>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">save /sys config</span></em></span></span></span></p>\n\n<ol>\n	<li style=\"list-style-type:none\">\n	<ol start=\"2\" style=\"list-style-type:upper-roman; margin-left:40px\">\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">To add multiple remote syslog servers:</span></strong></span></span></span>\n\n		<ul style=\"list-style-type:circle\">\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Enter the following command to log into the Traffic Management Shell:</span></span></span></li>\n		</ul>\n		</li>\n	</ol>\n	</li>\n</ol>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">tmsh</span></em></span></span></span></p>\n\n<ol>\n	<li style=\"list-style-type:none\">\n	<ol>\n		<li style=\"list-style-type:none\">\n		<ul style=\"list-style-type:circle; margin-left:40px\">\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Add the servers using the following command syntax:</span></span></span></li>\n		</ul>\n		</li>\n	</ol>\n	</li>\n</ol>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">modify /sys syslog remote-servers add { &lt;name&gt; { host &lt;IP address&gt; remote-port &lt;port&gt; } &lt;name&gt; { host &lt;IP address&gt; remote-port &lt;port&gt; } }</span></em></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For example, to add remote syslog server <strong>xx.xx.xx.xx</strong> on port <strong>514</strong> and name <strong>mysyslogA</strong> and remote syslog server <strong>xx.xx.xx.xx</strong> on port <strong>514</strong> and name <strong>mysyslogB</strong>, enter the following command:</span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">modify /sys syslog remote-servers add { <strong>mysyslogA</strong> { host <strong>172.28.31.40</strong> remote-port <strong>514</strong> } <strong>mysyslogB</strong> { host <strong>172.28.31.37</strong> remote-port <strong>514</strong> } }</span></span></span></p>\n\n<ol>\n	<li style=\"list-style-type:none\">\n	<ol>\n		<li style=\"list-style-type:none\">\n		<ol start=\"3\" style=\"margin-left:40px\">\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To save the configuration, enter the following command:</span></span></span></li>\n		</ol>\n		</li>\n	</ol>\n	</li>\n</ol>\n\n<p style=\"margin-left:160px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><em><span style=\"color:#0070c0\">save /sys config</span></em></span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">F5 Big-IP ADC</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; F5 Big-IP ADC to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n</body>\n</html>\n',29,20,NULL,1,2,NULL),(33,'Log Forwarding Steps','Log forwarding steps for F5 Big IP ASM, versions starting at v10.1 and greater','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Device versions starting at v10.1 and greater are supported.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ol style=\"list-style-type:upper-alpha\">\n	<li style=\"text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Configuring a logging profile</span></span></span>\n\n	<ol style=\"list-style-type:upper-roman\">\n		<li style=\"text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">Creating a logging profile</span></strong></span></span></span>\n\n		<ul>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">On the <strong>Main</strong> tab, expand <strong>Application Security</strong>, point to <strong>Options</strong>, and then click <strong>Logging Profiles</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Above the Logging Profiles area, click the <strong>Create</strong> button</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For the <strong>Configuration</strong> setting, select <strong>Advanced</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For the <strong>Profile Name</strong> setting, type a unique name for the logging profile.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">If you do not want to log data locally on the BIG-IP system, clear the <strong>Local Storage</strong> check box. Otherwise, leave it selected.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">From the Response Logging list, select &ldquo;<strong>For All Requests</strong>&rdquo;</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the <strong>Remote Storage</strong> check box.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">From the <strong>Remote Storage Type</strong>, select <strong>ArcSight</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For the <strong>Protocol</strong> setting, select <strong>UDP</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For <strong>Server Addresses</strong>, specify LEC Server to send log traffic. Type the IP address, port number (default is <strong>514</strong>) and click <strong>Add</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">When using the <strong>Remote Storage Type</strong>, for <strong>Facility</strong>, select the <strong>LOG_LOCAL6</strong></span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">When using the <strong>Remote</strong> storage type, refer the CEF Formats in section 5 &ldquo;CEF Formats&rdquo; in the <strong>Storage Format</strong> setting, you can specify how the log displays information, which traffic items the server logs, and what order it logs them.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click the <strong>Create</strong> button</span></span></span></li>\n		</ul>\n		</li>\n		<li style=\"text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">To apply a logging profile to a security policy:</span></strong></span></span></span>\n		<ul>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">On the Main tab, click <strong>Security Policies</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click the name of the security policy.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For Logging Profile, select the profile you want to use for the security policy.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click <strong>Update</strong>.</span></span></span></li>\n			<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Similarly, you can apply created the logging profile to all the applicable security policies</span></span></span></li>\n		</ul>\n		</li>\n	</ol>\n	</li>\n</ol>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">B. </span></span></span><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Configuring a Storage Filter</span></span></span></p>\n\n<ol style=\"list-style-type:upper-roman; margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><span style=\"color:#c00000\">To configure the Storage Filter</span></strong></span></span></span>\n\n	<ul>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">On the Main tab, expand <strong>Application Security</strong>, point to <strong>Options</strong>, and then click <strong>Logging Profiles</strong>.</span></span></span></li>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">In the Logging Profiles area, click the name of an existing logging profile.</span></span></span></li>\n		<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">For the <strong>Storage Filter</strong> setting, select <strong>Advanced</strong>.</span></span></span></li>\n	</ul>\n	</li>\n</ol>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">F5 Big-IP ASM</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">515</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;LEC Server&rdquo; &amp; F5 Big-IP ASM to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n</body>\n</html>\n',31,22,NULL,1,NULL,NULL),(34,'Log Forwarding Steps','Log forwarding steps for FireEye version(s) 8.2.0 ','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-right:0in; text-align:justify\"><span style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1.&nbsp;Versions Supported</strong></span></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">FireEye version(s) 8.2.0 is supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">The appliance must have an established connection to the Internet. </span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You must have Admin or Operator access to the appliance.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">On the Web UI, under Rsyslog settings select the <strong>Settings</strong> tab.</span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Select <strong>Notifications</strong> on the side bar.</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Click the <strong>rsyslog</strong> column heading to display the Rsyslog Settings area in the Settings column.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select Common Event Format (<strong>CEF</strong>)</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the delivery frequency as <strong>Per Event</strong> in the drop-down list</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Select the severity classification as <strong>Alert</strong> for the rsyslog notification in the <strong>Send as</strong> box</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Next to the &ldquo;<strong>Add Rsyslog Server</strong>&rdquo; button, type &ldquo;LEC Forwarding&rdquo;. Then click the &ldquo;Add Rsyslog Server&rdquo; button. Enter the IP address of the LEC server in the &ldquo;IP Address&rdquo; field and click the &ldquo;Update&rdquo; button below. Change the protocol dropdown to UDP.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You can test the sending and receiving of notifications on the same FireEye Notifications page by clicking the &ldquo;Test-Fire&rdquo; button at the bottom.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">FireEye</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;Log Collector Server&rdquo; &amp; FireEye to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n</body>\n</html>\n',30,23,NULL,1,NULL,NULL),(35,'Log Forwarding Steps','Log forwarding steps for Cisco IOS 2600 series and later with IOS 12.4, 15.0, 15.1, 15.2, 15.3, 15.4, 15.5, and 15.6','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\">Cisco IOS 2600 series and later with IOS 12.4, 15.0, 15.1, 15.2, 15.3, 15.4, 15.5, and 15.6</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\">Telnet to your IOS device.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\">Within the console, enter enable mode by entering <strong>enable</strong> or <strong>en</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\">Enter configuration mode by entering <strong>configure terminal</strong> or <strong>conf t</strong>.</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\">By default, log messages are not time-stamped. To enable time-stamping of log messages and debug messages</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\"><strong><em>Router(Config)#service timestamps log datetime localtime</em></strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\"><strong><em>Router(Config)#service timestamps debug datetime localtime</em></strong></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">System message logging is enabled by default. It must be enabled to send messages to any destination other than the console. To reenable message logging after it has been disabled, use the following command</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\"><strong><em>Router(config)#logging on</em></strong></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To set the syslog server that is to receive logging messages, use the following command</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><em>Router(config)#logging &lt;IP of the LEC Server&gt;</em></strong></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">You can limit the number of messages by specifying the severity level of the error message. To do so, use the following command</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><em>Router(config)#logging trap 6</em></strong></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">To define UNIX system facility message logging, use the following command</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong><em>Router(config)#logging facility LOCAL6</em></strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note: </strong>All the above commands must be executed in global configuration mode.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"color:#ffffff\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Cisco Switches/Routers</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:10pt\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;Cisco Switches/Routers&rdquo; &amp; &ldquo;LEC Server&rdquo; to be integrated are in different networks, above mentioned network port access connectivity shall be required for integration.</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Logging Guidelines</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif; font-size:10pt\">You can limit the number of messages by specifying the severity level of the error message. To do so, use the following command in global configuration mode:</span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif; font-size:10pt\"><img alt=\"\" src=\"	https://mdr-connect.paladion.net:5000/uploads/icon_image-1550137444259_IOS.png\" style=\"height:140px; width:400px\" /></span></p>\n</body>\n</html>\n',26,19,NULL,1,1,NULL),(36,'Log Forwarding Steps','Log forwarding steps for McAfee Network Security Manager versions 7.5, 8.0, 8.1, 8.2, 8.3, and 9.1','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Network Security Manager versions 7.5, 8.0, 8.1, 8.2, 8.3, and 9.1 are supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12pt\"><span style=\"color:#00b0f0\"><span style=\"font-size:11.0pt\"><span style=\"color:black\"><span style=\"font-size:12px\">Create a local SQL server user with username &ldquo;arcsight&rdquo;</span></span></span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Grant permissions for the database log table</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Configure MySQL to allow connections from the host where the SmartConnector for McAfee Network Security Manager DB is running.</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Execute a command such as below in a MySQL prompt to allow MySQL access:</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">GRANT SELECT ON IntruShielddb.* to MySQLuser@&#39;agenthost&#39; identified by &#39;MySQLpassword&#39;;</span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Parameter definition</span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#000000\">IntruShielddb - The name of the database used by IntruShield</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#000000\">MySQLuser - The user that you created for the LEC server to access the MySQL database</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#000000\">AgentHost - The host name/IP address of LEC server</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#000000\">MySQLPassword - The password of the user you created for the ArcSight User</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>4. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Intrushield</span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">3306</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n</body>\n</html>\n',32,24,NULL,1,NULL,NULL),(37,'Log Forwarding Steps','Log forwarding steps for McAfee Network Security Manager [Time Based] versions 7.5, 8.0, 8.1, 8.2, 8.3, and 9.1 ','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Network Security Manager versions 7.5, 8.0, 8.1, 8.2, 8.3, and 9.1 are supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Prerequisites</strong></span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Create a local SQL server user with username as &ldquo;arcsight&rdquo;</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Grant permission for the database log table</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Log Forwarding Steps</strong></span></span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Configure MySQL to allow connections from the host where the SmartConnector for McAfee Network Security Manager DB is running. </span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#00b0f0\"><span style=\"color:black\">Execute a command such as the following in a MySQL prompt to allow MySQL access:</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">GRANT SELECT ON NetworkSecurityMangerdb.* to MySQLuser@&#39;agenthost&#39; identified by &#39;MySQLpassword&#39;;</span></span></span></p>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Parameter definition</span></span></p>\n\n<ul style=\"margin-left:80px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">NetworkSecurityManagerdb - The name of the database used by Network Security Manager</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">MySQLuser - The user that you created for the LEC server to access the MySQL database</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">AgentHost - The host name of LEC server</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">MySQLPassword - The password of the user you created for the ArcSight User</span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><strong><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><span style=\"font-size:14.0pt\">4. Connectivity Requirements</span></span></span></span></strong></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>NSM DB</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">3306</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n</body>\n</html>\n',32,24,NULL,1,NULL,NULL),(39,'Log Forwarding Steps ','Log Forwarding Steps for McAfee Web Gateway version 7.6 ','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Web Gateway version 7.6 for Access Log is supported</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Log Forwarding Steps</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:16px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c00000\">Configure the syslog daemon (rsyslog)</span></strong></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Select <strong>Configuration</strong> at the top of the window and select the <strong>File Editor tab</strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Select the <strong>rsyslog.conf</strong> file under the appliance name in the left pane</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">To send the data to the LEC server using UDP, add a line similar to the line below to the end of the file&nbsp; </span></span></li>\n</ul>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>01.daemon.info;auth.=info @&lt;LEC Server IP address or hostname&gt;:514</strong></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:justify\"><span style=\"font-size:14px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong><span style=\"color:#c00000\">Configure the Rules</span></strong></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">To send all access log data to the LEC server, click <strong>Policy</strong> at the top of the window and select <strong>Access Log and Log Handler</strong> in the left pane</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Click the Show details tab and make sure Send to syslog is <strong>enabled</strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\">Click <strong>Save</strong> Changes to save any changes you have made.</span></span></li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:justify\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:.5in; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:106.3pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Web Gateway</strong></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:92.15pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">LEC Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">UDP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">514</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n</body>\n</html>\n',33,21,NULL,1,NULL,NULL),(40,'Log Forwarding Steps ','Log Forwarding Steps for Microsoft Exchange Servers 2007, 2010, 2013, 2013 SP1 & 2016','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>1. Versions Supported</strong></span></span></span></p>\n\n<p style=\"margin-left:80px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\">Microsoft Exchange Servers 2007, 2010, 2013, 2013 SP1 &amp; 2016</span></span></span></p>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>2. Configuration</strong></span></span></span></p>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:16pt\"><span style=\"color:#c10017\"><strong>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-size:12px\">&nbsp;<span style=\"color:black\">Enable Message Tracking for Exchange 2016 Using EAC</span></span></strong></span></span></span></p>\n\n<ul style=\"list-style-type:circle; margin-left:40px\">\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">Open the EAC and navigate to&nbsp;<strong>Servers</strong>&nbsp;&gt;&nbsp;<strong>Servers</strong>&nbsp;&gt; select the Mailbox server that you want to configure &gt; and click&nbsp;<strong>Edit</strong></span></span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:black\">On the server properties page, click&nbsp;<strong>Transport Logs</strong>. In the&nbsp;<strong>Message tracking log</strong>&nbsp;section, change any of the following settings:-</span></span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><strong><span style=\"color:black\">Enable message tracking log</span></strong><span style=\"color:black\">: To disable message tracking on the server, clear the check box. To enable message tracking on the server, select the check box</span></span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><strong><span style=\"color:black\">Message tracking log path</span></strong><span style=\"color:black\">: The value you specify must be on the local Exchange server. If the folder doesn&#39;t exist, it&#39;s created for you when you click&nbsp;<strong>Save</strong></span></span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"background-color:white\"><span style=\"color:#00b0f0\"><span style=\"color:black\">When you&#39;re finished, click</span>&nbsp;<span style=\"color:black\">Save</span></span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0.25in; margin-right:0in; text-align:left\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"font-size:12pt\"><span style=\"background-color:white\"><span style=\"color:#00b0f0\"><strong><span style=\"color:black\"><span style=\"font-size:14px\">Enable Message Tracking for Exchange 2013 SP1 and earlier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp; </span></strong></span></span></span></span></p>\n\n<ul style=\"margin-left:40px\">\n	<li style=\"text-align:left\">&nbsp;<span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">In the Exchange System Manager, right-click an Exchange server, then select Properties.</span></span></span></span></li>\n	<li style=\"text-align:left\">&nbsp;<span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">On the General tab, select the Enable message tracking check box.</span></span></span></span></li>\n	<li style=\"text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><span style=\"color:black\">In the Remove files older than (days) text box, enter the number of days that you want the files to remain on the server before being deleted.</span></span></span></span>&nbsp;&nbsp;</li>\n</ul>\n\n<p style=\"margin-left:40px; text-align:left\"><span style=\"font-size:18px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#c10017\"><strong>3. Connectivity Requirements</strong></span></span></span></p>\n\n<table border=\"1\" cellspacing=\"0\" class=\"PlainTable11\" style=\"border-collapse:collapse; border:solid windowtext 1.0pt; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Source IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination IP</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Protocol</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Destination Port</strong></span></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"color:#ffffff\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><strong>Direction</strong></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Exchange Server</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">445</span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Log Collector Server</span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Exchange Server</span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">TCP</span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">139</span></span></span></p>\n			</td>\n			<td style=\"width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:40px; margin-right:0in; text-align:left\"><span style=\"font-size:12px\"><span style=\"font-family:Arial,Helvetica,sans-serif\"><span style=\"color:black\"><strong>Note:</strong> In case of &ldquo;Log Collector Server&rdquo; &amp; &ldquo;Exchange Server&rdquo; to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integrat</span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:left\">&nbsp;</p>\n</body>\n</html>\n',34,16,NULL,1,3,NULL),(41,'Test','Test','',5,14,NULL,1,1,NULL),(42,'Test','Test','',5,14,NULL,1,NULL,NULL),(43,'Test','Test','',5,14,NULL,1,NULL,NULL),(44,'Test','Test','',5,14,NULL,1,NULL,NULL),(45,'Test','Test','',5,14,NULL,1,NULL,NULL),(46,'Test','Test','',5,14,NULL,1,NULL,NULL),(47,'Test','Test','',5,14,NULL,1,NULL,NULL),(48,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">1. Versions Supported</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Microsoft Windows Server 2008 R2 &amp; above, Microsoft Windows 7 &amp; above</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">2. Windows Hosts Prerequisites</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">.NET 4.5, 4.5.2, 4.6, or 4.6.1</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Minimum PowerShell version 3 and above</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Note:</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> In case of PowerShell version lesser than 3, use the below link for downloading and installation of WMF 5.1</span></span></span></span></p>\n\n<p><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=54616\"><span style=\"font-size:10.0pt\"><span style=\"color:#0070c0\">https://www.microsoft.com/en-us/download/details.aspx?id=54616</span></span></a></span></span></p>\n\n<p><span style=\"font-size:11.0pt\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">3. Log Forwarding Steps</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Create a Read Only Domain User (username can be &ldquo;arcsight&rdquo;)</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Add the Domain User to <strong>&ldquo;Event Log Reader&rdquo;</strong> &amp; <strong>&ldquo;Windows Remote Management Users&rdquo;</strong> Group</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Enable windows auditing policy as per &ldquo;<strong>Logging Guidelines</strong>&rdquo; provided below</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Use the below providied&nbsp; to Invoke (Execute) permissions to Windows Remote Users Group on the respective windows servers and Configure WinRM HTTP &amp; HTTPS listeners on the windows servers</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:13.3333px\">Locate the &quot;</span></span><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Manage auditing and security log</span></span></span><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:13.3333px\">&quot;&nbsp;</span></span><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">policy&nbsp;under&nbsp;User Rights Assignment&nbsp;</span></span></span><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\">and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;&ldquo;Audit: Force audit policy subcategory settings&rdquo;&nbsp;under&nbsp;Computer Configuration &gt; Windows Settings &gt; Security settings&nbsp;&gt; Local Policies&nbsp;&gt;&nbsp;Security Options&nbsp;and enable&nbsp;the policy</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;the&nbsp;&ldquo;Deny log on locally&rdquo;&nbsp;and&nbsp;&ldquo;Deny log on through Remote Desktop Services&rdquo;&nbsp;under&nbsp;User Rights Assignment&nbsp;and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span></span></span></li>\n</ul>\n\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">&nbsp; &nbsp;&nbsp;</span></span></span></span></p>\n\n<p style=\"text-align:justify\">&nbsp; &nbsp; &nbsp; &nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Copy paste below Script and excute on powershell using elevation mode</span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Pal-MDR Windows Log forwarding enabling script</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">[CmdletBinding()]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Param (<br />\n&nbsp; &nbsp; [string]$SubjectName = $env:COMPUTERNAME,<br />\n&nbsp; &nbsp; [int]$CertValidityDays = 1095,<br />\n&nbsp; &nbsp; [switch]$SkipNetworkProfileCheck,<br />\n&nbsp; &nbsp; $CreateSelfSignedCert = $true,<br />\n&nbsp; &nbsp; [switch]$ForceNewSSLCert,<br />\n&nbsp; &nbsp; [switch]$GlobalHttpFirewallAccess,<br />\n&nbsp; &nbsp; [switch]$DisableBasicAuth = $false,<br />\n&nbsp; &nbsp; [switch]$EnableCredSSP<br />\n)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-Log<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-EventLog -LogName Application -Source $EventSource -EntryType Information -EventId 1 -Message $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-VerboseLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Verbose $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-HostLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Output $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function New-LegacySelfSignedCert<br />\n{<br />\n&nbsp; &nbsp; Param (<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [string]$SubjectName,<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [int]$ValidDays = 1095<br />\n&nbsp; &nbsp; )</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $hostnonFQDN = $env:computerName&nbsp;<br />\n&nbsp; &nbsp; $hostFQDN = [System.Net.Dns]::GetHostByName(($env:computerName)).Hostname<br />\n&nbsp; &nbsp; $SignatureAlgorithm = &quot;SHA256&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $name = New-Object -COM &quot;X509Enrollment.CX500DistinguishedName.1&quot;<br />\n&nbsp; &nbsp; $name.Encode(&quot;CN=$SubjectName&quot;, 0)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $key = New-Object -COM &quot;X509Enrollment.CX509PrivateKey.1&quot;<br />\n&nbsp; &nbsp; $key.ProviderName = &quot;Microsoft Enhanced RSA and AES Cryptographic Provider&quot;<br />\n&nbsp; &nbsp; $key.KeySpec = 1<br />\n&nbsp; &nbsp; $key.Length = 3072<br />\n&nbsp; &nbsp; $key.SecurityDescriptor = &quot;D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)&quot;<br />\n&nbsp; &nbsp; $key.MachineContext = 1<br />\n&nbsp; &nbsp; $key.ExportPolicy = 1<br />\n&nbsp; &nbsp; $key.Create()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $serverauthoid = New-Object -COM &quot;X509Enrollment.CObjectId.1&quot;<br />\n&nbsp; &nbsp; $serverauthoid.InitializeFromValue(&quot;1.3.6.1.5.5.7.3.1&quot;)<br />\n&nbsp; &nbsp; $ekuoids = New-Object -COM &quot;X509Enrollment.CObjectIds.1&quot;<br />\n&nbsp; &nbsp; $ekuoids.Add($serverauthoid)<br />\n&nbsp; &nbsp; $ekuext = New-Object -COM &quot;X509Enrollment.CX509ExtensionEnhancedKeyUsage.1&quot;<br />\n&nbsp; &nbsp; $ekuext.InitializeEncode($ekuoids)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert = New-Object -COM &quot;X509Enrollment.CX509CertificateRequestCertificate.1&quot;<br />\n&nbsp; &nbsp; $cert.InitializeFromPrivateKey(2, $key, &quot;&quot;)<br />\n&nbsp; &nbsp; $cert.Subject = $name<br />\n&nbsp; &nbsp; $cert.Issuer = $cert.Subject<br />\n&nbsp; &nbsp; $cert.NotBefore = (Get-Date).AddDays(-1)<br />\n&nbsp; &nbsp; $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SigOID = New-Object -ComObject X509Enrollment.CObjectId<br />\n&nbsp; &nbsp; $SigOID.InitializeFromValue(([Security.Cryptography.Oid]$SignatureAlgorithm).Value)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [string[]] $AlternativeName &nbsp;+= $hostnonFQDN<br />\n&nbsp; &nbsp; $AlternativeName += $hostFQDN<br />\n&nbsp; &nbsp; $IAlternativeNames = New-Object -ComObject X509Enrollment.CAlternativeNames</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; foreach ($AN in $AlternativeName)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName = New-Object -ComObject X509Enrollment.CAlternativeName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName.InitializeFromString(0x3,$AN)<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $IAlternativeNames.Add($AltName)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SubjectAlternativeName = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames<br />\n&nbsp; &nbsp; $SubjectAlternativeName.InitializeEncode($IAlternativeNames)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [String[]]$KeyUsage = (&quot;DigitalSignature&quot;, &quot;KeyEncipherment&quot;)<br />\n&nbsp; &nbsp; $KeyUsageObj = New-Object -ComObject X509Enrollment.CX509ExtensionKeyUsage<br />\n&nbsp; &nbsp; $KeyUsageObj.InitializeEncode([int][Security.Cryptography.X509Certificates.X509KeyUsageFlags]($KeyUsage))<br />\n&nbsp; &nbsp; $KeyUsageObj.Critical = $true</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert.X509Extensions.Add($KeyUsageObj)<br />\n&nbsp; &nbsp; $cert.X509Extensions.Add($ekuext)<br />\n&nbsp; &nbsp; $cert.SignatureInformation.HashAlgorithm = $SigOID<br />\n&nbsp; &nbsp; $CERT.X509Extensions.Add($SubjectAlternativeName)<br />\n&nbsp; &nbsp; $cert.Encode()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $enrollment = New-Object -COM &quot;X509Enrollment.CX509Enrollment.1&quot;<br />\n&nbsp; &nbsp; $enrollment.InitializeFromRequest($cert)<br />\n&nbsp; &nbsp; $certdata = $enrollment.CreateRequest(0)<br />\n&nbsp; &nbsp; $enrollment.InstallResponse(2, $certdata, 0, &quot;&quot;)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # extract/return the thumbprint from the generated cert<br />\n&nbsp; &nbsp; $parsed_cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2<br />\n&nbsp; &nbsp; $parsed_cert.Import([System.Text.Encoding]::UTF8.GetBytes($certdata))</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; return $parsed_cert.Thumbprint<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Enable-GlobalHttpFirewallAccess<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Forcing global HTTP firewall access&quot;<br />\n&nbsp; &nbsp; # this is a fairly naive implementation; could be more sophisticated about rule matching/collapsing<br />\n&nbsp; &nbsp; $fw = New-Object -ComObject HNetCfg.FWPolicy2</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # try to find/enable the default rule first<br />\n&nbsp; &nbsp; $add_rule = $false<br />\n&nbsp; &nbsp; $matching_rules = $fw.Rules | ? { $_.Name -eq &quot;Windows Remote Management (HTTP-In)&quot; }<br />\n&nbsp; &nbsp; $rule = $null<br />\n&nbsp; &nbsp; If ($matching_rules) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; If ($matching_rules -isnot [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing existing single HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Else {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # try to find one with the All or Public profile first<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Found multiple existing HTTP firewall rules...&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules | % { $_.Profiles -band 4 }[0]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (-not $rule -or $rule -is [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing an arbitrary single HTTP firewall rule (multiple existed)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # oh well, just pick the first one<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules[0]<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If (-not $rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Creating a new HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule = New-Object -ComObject HNetCfg.FWRule<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Name = &quot;Windows Remote Management (HTTP-In)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Description = &quot;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $add_rule = $true<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $rule.Profiles = 0x7FFFFFFF<br />\n&nbsp; &nbsp; $rule.Protocol = 6<br />\n&nbsp; &nbsp; $rule.LocalPorts = 5985<br />\n&nbsp; &nbsp; $rule.RemotePorts = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.LocalAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.RemoteAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.Enabled = $true<br />\n&nbsp; &nbsp; $rule.Direction = 1<br />\n&nbsp; &nbsp; $rule.Action = 1<br />\n&nbsp; &nbsp; $rule.Grouping = &quot;Windows Remote Management&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If ($add_rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $fw.Rules.Add($rule)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;HTTP firewall rule $($rule.Name) updated&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Setup error handling.<br />\nTrap<br />\n{<br />\n&nbsp; &nbsp; $_<br />\n&nbsp; &nbsp; Exit 1<br />\n}<br />\n$ErrorActionPreference = &quot;Stop&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the ID and security principal of the current user account<br />\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the security principal for the Administrator role<br />\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check to see if we are currently running &quot;as Administrator&quot;<br />\nif (-Not $myWindowsPrincipal.IsInRole($adminRole))<br />\n{<br />\n&nbsp; &nbsp; Write-Output &quot;ERROR: You need elevated Administrator privileges in order to run this script.&quot;<br />\n&nbsp; &nbsp; Write-Output &quot; &nbsp; &nbsp; &nbsp; Start Windows PowerShell by using the Run as Administrator option.&quot;<br />\n&nbsp; &nbsp; Exit 2<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$EventSource = $MyInvocation.MyCommand.Name<br />\nIf (-Not $EventSource)<br />\n{<br />\n&nbsp; &nbsp; $EventSource = &quot;Powershell CLI&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ([System.Diagnostics.EventLog]::Exists(&#39;Application&#39;) -eq $False -or [System.Diagnostics.EventLog]::SourceExists($EventSource) -eq $False)</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><u><span style=\"color:black\">{</span></u><br />\n<span style=\"color:black\">&nbsp; &nbsp; New-EventLog -LogName Application -Source $EventSource<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Detect PowerShell version.<br />\nIf ($PSVersionTable.PSVersion.Major -lt 3)<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:PowerShell version 3 or higher is required.&quot;<br />\n&nbsp; &nbsp; Throw &quot;PowerShell version 3 or higher is required.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Find and start the WinRM service.<br />\nWrite-Verbose &quot;Verifying WinRM service.&quot;<br />\nIf (!(Get-Service &quot;WinRM&quot;))<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to find the WinRM service.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to find the WinRM service.&quot;<br />\n}<br />\nElseIf ((Get-Service &quot;WinRM&quot;).Status -ne &quot;Running&quot;)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Setting WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Set-Service -Name &quot;WinRM&quot; -StartupType Automatic<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Set WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Write-Verbose &quot;Starting WinRM service.&quot;<br />\n&nbsp; &nbsp; Start-Service -Name &quot;WinRM&quot; -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Started WinRM service.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># WinRM should be running; check that we have a PS session config.<br />\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))<br />\n{<br />\n&nbsp; If ($SkipNetworkProfileCheck) {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting without checking Network profile.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting without checking Network profile.&quot;<br />\n&nbsp; }<br />\n&nbsp; Else {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting.&quot;<br />\n&nbsp; }<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;PS Remoting is already enabled.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Make sure there is a SSL listener.<br />\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener<br />\nIf (!($listeners | Where {$_.Keys -like &quot;TRANSPORT=HTTPS&quot;}))<br />\n{<br />\n&nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Create the hashtables of settings to be used.<br />\n&nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;Enabling SSL listener.&quot;<br />\n&nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled SSL listener.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;SSL listener is already active.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Force a new SSL cert on Listener if the $ForceNewSSLCert<br />\n&nbsp; &nbsp; If ($ForceNewSSLCert)<br />\n&nbsp; &nbsp; {</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Delete the listener for SSL<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Remove-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Add new Listener with new SSL cert<br />\n&nbsp; &nbsp; &nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check for basic authentication.<br />\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where-Object {$_.Name -eq &quot;Basic&quot;}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($DisableBasicAuth)&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $true)&nbsp;<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Disabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $false<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Disabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already disabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}&nbsp;<br />\nElse&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $true<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Enabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already enabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># If EnableCredSSP if set to true<br />\nIf ($EnableCredSSP)<br />\n{<br />\n&nbsp; &nbsp; # Check for CredSSP authentication<br />\n&nbsp; &nbsp; $credsspAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq &quot;CredSSP&quot;}<br />\n&nbsp; &nbsp; If (($credsspAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Enable-WSManCredSSP -role server -Force<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($GlobalHttpFirewallAccess) {<br />\n&nbsp; &nbsp; Enable-GlobalHttpFirewallAccess<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Configure firewall to allow WinRM HTTPS connections.<br />\n$fwtest1 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot;<br />\n$fwtest2 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot; profile=any<br />\nIf ($fwtest1.count -lt 5)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Adding firewall rule to allow WinRM HTTPS.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall add rule profile=any name=&quot;Allow WinRM HTTPS&quot; dir=in localport=5986 protocol=TCP action=allow</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Log &quot;Added firewall rule to allow WinRM HTTPS.&quot;<br />\n}<br />\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Updating firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall set rule name=&quot;Allow WinRM HTTPS&quot; new profile=any<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Updated firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Firewall rule already exists to allow WinRM HTTPS.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Test a remoting connection to localhost, which should work.<br />\n$httpResult = Invoke-Command -ComputerName &quot;localhost&quot; -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue<br />\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$httpsResult = New-PSSession -UseSSL -ComputerName &quot;localhost&quot; -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($httpResult -and $httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpsResult -and !$httpResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Disabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpResult -and !$httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Disabled&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n}<br />\nWrite-VerboseLog &quot;Pal-MDR:PS Remoting has been successfully configured.&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">netsh advfirewall firewall add rule profile=any name=&quot;Allow NetBIOS&quot; dir=in localport=135 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow NetBIOS(135).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow WinC&quot; dir=in localport=49153 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow WinC(49153).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow MessageQueue &quot; dir=out localport=61616 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow Outbound MessageQueue(61616).&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">winrm s winrm/config/service &#39;@{RootSDDL=&quot;O:NSG:BAD:P(A;;GX;;;S-1-5-21-3438187023-432945961-1320742929-1000)(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;}&#39;</span></span></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Run it from a PowerShell prompt (In Administrative Mode). If the script is successful, an HTTPS listener will be created for the WinRM service.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">NOTE: </span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Before executing the script, make sure to replace with the SID of the domain user created<strong> </strong>at the end of the script<strong>.</strong></span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" style=\"height:19px; width:624px\" /></span></span></span></strong></span></span></p>\n\n<ol>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:12.0pt\"><span style=\"color:#c10017\">3.1 Advanced Audit Policy Configuration</span></span></strong></span></span></li>\n</ol>\n\n<ol>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Audit Process Creation&rdquo; under Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration&gt; Audit Policies&gt; Detailed Tracking and</span></span> <span style=\"font-size:10.0pt\"><span style=\"color:black\">configure <em>Success and Failure</em> audit event</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Include command line in process creation event&rdquo; under Computer Configuration &gt; Policies &gt; Administrative Template &gt; System &gt; Audit Process Creation and enable the policy</span></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">5. Connectivity Requirements</span></span></span></strong></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:undefined; margin-left:19.6pt; width:516.8pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Source IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Protocol</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination Port</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Direction</span></span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">49153</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">135</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5985</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5986</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">61616</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\">Note:</span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\"> In case of &ldquo;Log Collector Server&rdquo; &amp; Windows Server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">6. Logging Guidelines</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Note:</span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"> The below mentioned logging guidelines are based on best practices for security monitoring. However, keep in mind that auditing events consumes system resources such as memory, processing power, and disk space. The more events you audit, the more of these resources are consumed. Auditing an excessive number of events can dramatically slow down your servers.</span></span></span></span></p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(49,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body></body>\n</html>\n',5,14,NULL,1,NULL,NULL),(50,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(51,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(52,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(53,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(54,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,1,NULL),(55,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(56,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,5,NULL),(57,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(58,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(59,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p>Test</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(60,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:30.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">1. Versions Supported</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:60.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Microsoft Windows Server 2008 R2 &amp; above, Microsoft Windows 7 &amp; above</span></span></span></span></p>\n\n<p style=\"margin-left:30.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">2. Windows Hosts Prerequisites</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Minimum .net 4.5 and above</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Minimum PowerShell version 3 and above</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note:</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> In case of PowerShell version lesser than 3, use the below link for downloading and installation of WMF 5.1&nbsp;&nbsp;</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"font-size:10.0pt\"><span style=\"font-family:Titillium\"><span style=\"color:black\"><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=54616\" style=\"color:#0563c1; text-decoration:underline\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:#0070c0\">https://www.microsoft.com/en-us/download/details.aspx?id=54616</span></span></a></span></span></span></span></span></p>\n\n<p style=\"margin-left:30.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">3. Log Forwarding Steps</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Create a Read Only Domain User with username as &ldquo;</span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">mdruser</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">&rdquo;</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Add the Domain User to </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Event Log Reader&rdquo;</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> &amp; </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;WinRMRemoteWMIUsers&rdquo;</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> Group</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Use the below script attached to Invoke (Execute) permissions to Windows Remote Users Group on the respective windows servers and Configure WinRM HTTP &amp; HTTPS listeners on the windows servers</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:60.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">NOTE</span></span></span></strong><span style=\"font-size:7.5pt\"><span style=\"color:black\">: Its recommended to create a separate OU and add hosts which needs to be monitored, then apply below mentioned group policy to created OU.</span></span></span></span></p>\n\n<p style=\"margin-left:30.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Copy paste below Script and excute on powershell using elevation mode</span></span></strong></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Pal-MDR Windows Log forwarding enabling script</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">[CmdletBinding()]</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Param (<br />\n&nbsp; &nbsp; [string]$SubjectName = $env:COMPUTERNAME,<br />\n&nbsp; &nbsp; [int]$CertValidityDays = 1095,<br />\n&nbsp; &nbsp; [switch]$SkipNetworkProfileCheck,<br />\n&nbsp; &nbsp; $CreateSelfSignedCert = $true,<br />\n&nbsp; &nbsp; [switch]$ForceNewSSLCert,<br />\n&nbsp; &nbsp; [switch]$GlobalHttpFirewallAccess,<br />\n&nbsp; &nbsp; [switch]$DisableBasicAuth = $false,<br />\n&nbsp; &nbsp; [switch]$EnableCredSSP<br />\n)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-Log<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-EventLog -LogName Application -Source $EventSource -EntryType Information -EventId 1 -Message $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-VerboseLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Verbose $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-HostLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Output $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function New-LegacySelfSignedCert<br />\n{<br />\n&nbsp; &nbsp; Param (<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [string]$SubjectName,<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [int]$ValidDays = 1095<br />\n&nbsp; &nbsp; )</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $hostnonFQDN = $env:computerName&nbsp;<br />\n&nbsp; &nbsp; $hostFQDN = [System.Net.Dns]::GetHostByName(($env:computerName)).Hostname<br />\n&nbsp; &nbsp; $SignatureAlgorithm = &quot;SHA256&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $name = New-Object -COM &quot;X509Enrollment.CX500DistinguishedName.1&quot;<br />\n&nbsp; &nbsp; $name.Encode(&quot;CN=$SubjectName&quot;, 0)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $key = New-Object -COM &quot;X509Enrollment.CX509PrivateKey.1&quot;<br />\n&nbsp; &nbsp; $key.ProviderName = &quot;Microsoft Enhanced RSA and AES Cryptographic Provider&quot;<br />\n&nbsp; &nbsp; $key.KeySpec = 1<br />\n&nbsp; &nbsp; $key.Length = 3072<br />\n&nbsp; &nbsp; $key.SecurityDescriptor = &quot;D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)&quot;<br />\n&nbsp; &nbsp; $key.MachineContext = 1<br />\n&nbsp; &nbsp; $key.ExportPolicy = 1<br />\n&nbsp; &nbsp; $key.Create()</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $serverauthoid = New-Object -COM &quot;X509Enrollment.CObjectId.1&quot;<br />\n&nbsp; &nbsp; $serverauthoid.InitializeFromValue(&quot;1.3.6.1.5.5.7.3.1&quot;)<br />\n&nbsp; &nbsp; $ekuoids = New-Object -COM &quot;X509Enrollment.CObjectIds.1&quot;<br />\n&nbsp; &nbsp; $ekuoids.Add($serverauthoid)<br />\n&nbsp; &nbsp; $ekuext = New-Object -COM &quot;X509Enrollment.CX509ExtensionEnhancedKeyUsage.1&quot;<br />\n&nbsp; &nbsp; $ekuext.InitializeEncode($ekuoids)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert = New-Object -COM &quot;X509Enrollment.CX509CertificateRequestCertificate.1&quot;<br />\n&nbsp; &nbsp; $cert.InitializeFromPrivateKey(2, $key, &quot;&quot;)<br />\n&nbsp; &nbsp; $cert.Subject = $name<br />\n&nbsp; &nbsp; $cert.Issuer = $cert.Subject<br />\n&nbsp; &nbsp; $cert.NotBefore = (Get-Date).AddDays(-1)<br />\n&nbsp; &nbsp; $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SigOID = New-Object -ComObject X509Enrollment.CObjectId<br />\n&nbsp; &nbsp; $SigOID.InitializeFromValue(([Security.Cryptography.Oid]$SignatureAlgorithm).Value)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [string[]] $AlternativeName &nbsp;+= $hostnonFQDN<br />\n&nbsp; &nbsp; $AlternativeName += $hostFQDN<br />\n&nbsp; &nbsp; $IAlternativeNames = New-Object -ComObject X509Enrollment.CAlternativeNames</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; foreach ($AN in $AlternativeName)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName = New-Object -ComObject X509Enrollment.CAlternativeName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName.InitializeFromString(0x3,$AN)<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $IAlternativeNames.Add($AltName)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SubjectAlternativeName = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames<br />\n&nbsp; &nbsp; $SubjectAlternativeName.InitializeEncode($IAlternativeNames)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [String[]]$KeyUsage = (&quot;DigitalSignature&quot;, &quot;KeyEncipherment&quot;)<br />\n&nbsp; &nbsp; $KeyUsageObj = New-Object -ComObject X509Enrollment.CX509ExtensionKeyUsage<br />\n&nbsp; &nbsp; $KeyUsageObj.InitializeEncode([int][Security.Cryptography.X509Certificates.X509KeyUsageFlags]($KeyUsage))<br />\n&nbsp; &nbsp; $KeyUsageObj.Critical = $true</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert.X509Extensions.Add($KeyUsageObj)<br />\n&nbsp; &nbsp; $cert.X509Extensions.Add($ekuext)<br />\n&nbsp; &nbsp; $cert.SignatureInformation.HashAlgorithm = $SigOID<br />\n&nbsp; &nbsp; $CERT.X509Extensions.Add($SubjectAlternativeName)<br />\n&nbsp; &nbsp; $cert.Encode()</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $enrollment = New-Object -COM &quot;X509Enrollment.CX509Enrollment.1&quot;<br />\n&nbsp; &nbsp; $enrollment.InitializeFromRequest($cert)<br />\n&nbsp; &nbsp; $certdata = $enrollment.CreateRequest(0)<br />\n&nbsp; &nbsp; $enrollment.InstallResponse(2, $certdata, 0, &quot;&quot;)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # extract/return the thumbprint from the generated cert<br />\n&nbsp; &nbsp; $parsed_cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2<br />\n&nbsp; &nbsp; $parsed_cert.Import([System.Text.Encoding]::UTF8.GetBytes($certdata))</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; return $parsed_cert.Thumbprint<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Enable-GlobalHttpFirewallAccess<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Forcing global HTTP firewall access&quot;<br />\n&nbsp; &nbsp; # this is a fairly naive implementation; could be more sophisticated about rule matching/collapsing<br />\n&nbsp; &nbsp; $fw = New-Object -ComObject HNetCfg.FWPolicy2</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # try to find/enable the default rule first<br />\n&nbsp; &nbsp; $add_rule = $false<br />\n&nbsp; &nbsp; $matching_rules = $fw.Rules | ? { $_.Name -eq &quot;Windows Remote Management (HTTP-In)&quot; }<br />\n&nbsp; &nbsp; $rule = $null<br />\n&nbsp; &nbsp; If ($matching_rules) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; If ($matching_rules -isnot [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing existing single HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Else {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # try to find one with the All or Public profile first<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Found multiple existing HTTP firewall rules...&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules | % { $_.Profiles -band 4 }[0]</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (-not $rule -or $rule -is [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing an arbitrary single HTTP firewall rule (multiple existed)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # oh well, just pick the first one<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules[0]<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If (-not $rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Creating a new HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule = New-Object -ComObject HNetCfg.FWRule<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Name = &quot;Windows Remote Management (HTTP-In)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Description = &quot;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $add_rule = $true<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $rule.Profiles = 0x7FFFFFFF<br />\n&nbsp; &nbsp; $rule.Protocol = 6<br />\n&nbsp; &nbsp; $rule.LocalPorts = 5985<br />\n&nbsp; &nbsp; $rule.RemotePorts = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.LocalAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.RemoteAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.Enabled = $true<br />\n&nbsp; &nbsp; $rule.Direction = 1<br />\n&nbsp; &nbsp; $rule.Action = 1<br />\n&nbsp; &nbsp; $rule.Grouping = &quot;Windows Remote Management&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If ($add_rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $fw.Rules.Add($rule)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;HTTP firewall rule $($rule.Name) updated&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Setup error handling.<br />\nTrap<br />\n{<br />\n&nbsp; &nbsp; $_<br />\n&nbsp; &nbsp; Exit 1<br />\n}<br />\n$ErrorActionPreference = &quot;Stop&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the ID and security principal of the current user account<br />\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the security principal for the Administrator role<br />\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check to see if we are currently running &quot;as Administrator&quot;<br />\nif (-Not $myWindowsPrincipal.IsInRole($adminRole))<br />\n{<br />\n&nbsp; &nbsp; Write-Output &quot;ERROR: You need elevated Administrator privileges in order to run this script.&quot;<br />\n&nbsp; &nbsp; Write-Output &quot; &nbsp; &nbsp; &nbsp; Start Windows PowerShell by using the Run as Administrator option.&quot;<br />\n&nbsp; &nbsp; Exit 2<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$EventSource = $MyInvocation.MyCommand.Name<br />\nIf (-Not $EventSource)<br />\n{<br />\n&nbsp; &nbsp; $EventSource = &quot;Powershell CLI&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ([System.Diagnostics.EventLog]::Exists(&#39;Application&#39;) -eq $False -or [System.Diagnostics.EventLog]::SourceExists($EventSource) -eq $False)</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><u><span style=\"color:black\">{</span></u><br />\n<span style=\"color:black\">&nbsp; &nbsp; New-EventLog -LogName Application -Source $EventSource<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Detect PowerShell version.<br />\nIf ($PSVersionTable.PSVersion.Major -lt 3)<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:PowerShell version 3 or higher is required.&quot;<br />\n&nbsp; &nbsp; Throw &quot;PowerShell version 3 or higher is required.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Find and start the WinRM service.<br />\nWrite-Verbose &quot;Verifying WinRM service.&quot;<br />\nIf (!(Get-Service &quot;WinRM&quot;))<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to find the WinRM service.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to find the WinRM service.&quot;<br />\n}<br />\nElseIf ((Get-Service &quot;WinRM&quot;).Status -ne &quot;Running&quot;)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Setting WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Set-Service -Name &quot;WinRM&quot; -StartupType Automatic<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Set WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Write-Verbose &quot;Starting WinRM service.&quot;<br />\n&nbsp; &nbsp; Start-Service -Name &quot;WinRM&quot; -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Started WinRM service.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># WinRM should be running; check that we have a PS session config.<br />\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))<br />\n{<br />\n&nbsp; If ($SkipNetworkProfileCheck) {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting without checking Network profile.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting without checking Network profile.&quot;<br />\n&nbsp; }<br />\n&nbsp; Else {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting.&quot;<br />\n&nbsp; }<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;PS Remoting is already enabled.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Make sure there is a SSL listener.<br />\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener<br />\nIf (!($listeners | Where {$_.Keys -like &quot;TRANSPORT=HTTPS&quot;}))<br />\n{<br />\n&nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Create the hashtables of settings to be used.<br />\n&nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;Enabling SSL listener.&quot;<br />\n&nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled SSL listener.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;SSL listener is already active.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Force a new SSL cert on Listener if the $ForceNewSSLCert<br />\n&nbsp; &nbsp; If ($ForceNewSSLCert)<br />\n&nbsp; &nbsp; {</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Delete the listener for SSL<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Remove-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Add new Listener with new SSL cert<br />\n&nbsp; &nbsp; &nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check for basic authentication.<br />\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where-Object {$_.Name -eq &quot;Basic&quot;}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($DisableBasicAuth)&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $true)&nbsp;<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Disabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $false<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Disabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already disabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}&nbsp;<br />\nElse&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $true<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Enabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already enabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># If EnableCredSSP if set to true<br />\nIf ($EnableCredSSP)<br />\n{<br />\n&nbsp; &nbsp; # Check for CredSSP authentication<br />\n&nbsp; &nbsp; $credsspAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq &quot;CredSSP&quot;}<br />\n&nbsp; &nbsp; If (($credsspAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Enable-WSManCredSSP -role server -Force<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($GlobalHttpFirewallAccess) {<br />\n&nbsp; &nbsp; Enable-GlobalHttpFirewallAccess<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Configure firewall to allow WinRM HTTPS connections.<br />\n$fwtest1 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot;<br />\n$fwtest2 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot; profile=any<br />\nIf ($fwtest1.count -lt 5)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Adding firewall rule to allow WinRM HTTPS.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall add rule profile=any name=&quot;Allow WinRM HTTPS&quot; dir=in localport=5986 protocol=TCP action=allow</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Log &quot;Added firewall rule to allow WinRM HTTPS.&quot;<br />\n}<br />\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Updating firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall set rule name=&quot;Allow WinRM HTTPS&quot; new profile=any<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Updated firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Firewall rule already exists to allow WinRM HTTPS.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Test a remoting connection to localhost, which should work.<br />\n$httpResult = Invoke-Command -ComputerName &quot;localhost&quot; -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue<br />\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$httpsResult = New-PSSession -UseSSL -ComputerName &quot;localhost&quot; -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue</span></span></span></span></span></p>\n\n<p style=\"margin-left:150.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($httpResult -and $httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpsResult -and !$httpResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Disabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpResult -and !$httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Disabled&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n}<br />\nWrite-VerboseLog &quot;Pal-MDR:PS Remoting has been successfully configured.&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">netsh advfirewall firewall add rule profile=any name=&quot;Allow NetBIOS&quot; dir=in localport=135 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow NetBIOS(135).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow WinC&quot; dir=in localport=49153 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow WinC(49153).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow MessageQueue &quot; dir=out localport=61616 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow Outbound MessageQueue(61616).&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">winrm s winrm/config/service &#39;@{RootSDDL=&quot;O:NSG:BAD:P(A;;GX;;;S-1-5-21-3438187023-432945961-1320742929-1000)(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;}&#39;</span></span></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Run it from a PowerShell prompt (In Administrative Mode). If the script is successful, an HTTPS listener will be created for the WinRM service.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:60.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">NOTE: </span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Before executing the script, make sure to replace with the SID of the domain user created<strong> </strong>at the end of the script<strong><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">.</span></strong></span></span></span></span></span></p>\n\n<p style=\"margin-left:60.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"><img src=\"file:///C:\\Users\\CHINTA~1.SAH\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" style=\"height:41px; width:1341px\" /></span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:60.0pt; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Manage auditing and security log&rdquo;, &ldquo;Deny log on locally&rdquo;&nbsp;&amp; &ldquo;Deny log on through Remote Desktop Services&rdquo; policy under User Rights Assignment and add the &ldquo;mdruser&rdquo; user</span></span></strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Audit: Force audit policy subcategory settings&rdquo; under Computer Configuration &gt; Windows Settings &gt; Security settings &gt; Local Policies &gt; Security Options and enable the policy</span></span></strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\">&nbsp;<span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate </span></span>&nbsp;<strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Include command line in process creation event&rdquo; under Computer Configuration &gt; Policies &gt; Administrative Template &gt; System &gt; Audit Process Creation and enable the policy</span></span></strong></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Maximum security log size&rdquo; under Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Event Log and set the value to </span></span></strong><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:#00b0f0\">&ldquo;2,097,152&rdquo;</span></span></strong><strong> </strong><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">kilobytes</span></span></strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Configure windows auditing policy as per below &ldquo;</span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Logging Guidelines</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">&rdquo;.</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">4. Connectivity Requirements</span></span></span></strong></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:inset 1.0pt; margin-left:19.6pt; width:516.8pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Source IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Protocol</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination Port</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Direction</span></span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">49153</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">135</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5985</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5986</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">61616</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:30.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Note:</span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"color:black\"> In case of &ldquo;Log Collector Server&rdquo; &amp; Windows Server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></span></p>\n\n<p style=\"margin-left:30.0pt; margin-right:0in; text-align:justify\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">5. Logging Guidelines</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:30.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Note:</span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"> The below mentioned logging guidelines are based on best practices for security monitoring. However, keep in mind that auditing events consumes system resources such as memory, processing power, and disk space. The more events you audit, the more of these resources are consumed. Auditing an excessive number of events can dramatically slow down your servers.</span></span></span></span></p>\n\n<ul>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate </span></span><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&ldquo;Audit Policies&rdquo; under Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration and enable the policies as per below table</span></span></strong></span></span></li>\n</ul>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:inset 1.0pt; margin-left:19.6pt; width:519.15pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; height:16.75pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Audit Category</span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:16.75pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Audit Subcategory</span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; height:16.75pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Audit Events</span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td rowspan=\"3\" style=\"background-color:#f2f2f2; height:16.75pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Account Logon</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:16.75pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Credential Validation</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:16.75pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Kerberos Service Ticket Operations</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Kerberos Authentication Service</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td rowspan=\"3\" style=\"height:16.75pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Account Management</span></span></span></span></p>\n			</td>\n			<td style=\"height:16.75pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">User Account Management</span></span></span></span></p>\n			</td>\n			<td style=\"height:16.75pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Computer Account Management</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Security Group Management</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:16.75pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Detailed Tracking</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:16.75pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Audit Process Creation</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:16.75pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success, Failure</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:16.75pt; vertical-align:top; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">DS Access</span></span></span></span></p>\n			</td>\n			<td style=\"height:16.75pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Directory Service Access</span></span></span></span></p>\n			</td>\n			<td style=\"height:16.75pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td rowspan=\"5\" style=\"background-color:#f2f2f2; height:15.7pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Logon/Logoff</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Logon</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success, Failure</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Logoff</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Account Lockout</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Special Logon</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Network Policy Server</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success, Failure</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; vertical-align:top; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Object Access</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Audit File Share</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td rowspan=\"2\" style=\"background-color:#f2f2f2; height:15.7pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Policy Change</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Audit Policy Change</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"height:15.7pt; vertical-align:top; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Authentication Policy Change</span></span></span></span></p>\n			</td>\n			<td style=\"height:15.7pt; vertical-align:top; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:114.85pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Privilege Use</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:288.95pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Audit Sensitive Privilege Use</span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; height:15.7pt; width:115.35pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><span style=\"font-size:10.0pt\"><span style=\"color:#262626\">Success</span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:30.0pt; margin-right:0in\"><span style=\"font-size:12pt\"><span style=\"font-family:&quot;Times New Roman&quot;,serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">6. Paladion Requirements</span></span></span></strong></span></span></p>\n\n<ul>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Domain controller IP address.</span></span></strong></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Created mdruser credential.</span></span></strong></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Domain details &ldquo;abc.com&rdquo; / &ldquo;abc.net&rdquo;</span></span></strong></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Created OU details (If it&rsquo;s created separately or else it can be ignored)</span></span></strong></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in\">&nbsp;</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(61,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">1. Versions Supported</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Microsoft Windows Server 2008 R2 &amp; above, Microsoft Windows 7 &amp; above</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">2. Windows Hosts Prerequisites</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">.NET 4.5, 4.5.2, 4.6, or 4.6.1</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Minimum PowerShell version 3 and above</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Note:</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> In case of PowerShell version lesser than 3, use the below link for downloading and installation of WMF 5.1</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=54616\"><span style=\"font-size:10.0pt\"><span style=\"color:#0070c0\">https://www.microsoft.com/en-us/download/details.aspx?id=54616</span></span></a></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">3. Log Forwarding Steps</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Create a Read Only Domain User (username can be &ldquo;arcsight&rdquo;)</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Add the Domain User to <strong>&ldquo;Event Log Reader&rdquo;</strong> &amp; <strong>&ldquo;Windows Remote Management Users&rdquo;</strong> Group</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Enable windows auditing policy as per &ldquo;<strong>Logging Guidelines</strong>&rdquo; provided below</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Use the below providied&nbsp; to Invoke (Execute) permissions to Windows Remote Users Group on the respective windows servers and Configure WinRM HTTP &amp; HTTPS listeners on the windows servers</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Locate the &quot;</span><span style=\"font-size:9.0pt\">Manage auditing and security log</span><span style=\"font-size:10.0pt\">&quot;&nbsp;</span><span style=\"font-size:9.0pt\">policy&nbsp;under&nbsp;User Rights Assignment&nbsp;and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span> </span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;the&nbsp;&ldquo;Deny log on locally&rdquo;&nbsp;and&nbsp;&ldquo;Deny log on through Remote Desktop Services&rdquo;&nbsp;under&nbsp;User Rights Assignment&nbsp;and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;&ldquo;Audit: Force audit policy subcategory settings&rdquo;&nbsp;under&nbsp;Computer Configuration &gt; Windows Settings &gt; Security settings&nbsp;&gt; Local Policies&nbsp;&gt;&nbsp;Security Options&nbsp;and enable&nbsp;the policy&nbsp;</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Copy paste below Script and excute on powershell using elevation mode</span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Pal-MDR Windows Log forwarding enabling script</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">[CmdletBinding()]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Param (<br />\n&nbsp; &nbsp; [string]$SubjectName = $env:COMPUTERNAME,<br />\n&nbsp; &nbsp; [int]$CertValidityDays = 1095,<br />\n&nbsp; &nbsp; [switch]$SkipNetworkProfileCheck,<br />\n&nbsp; &nbsp; $CreateSelfSignedCert = $true,<br />\n&nbsp; &nbsp; [switch]$ForceNewSSLCert,<br />\n&nbsp; &nbsp; [switch]$GlobalHttpFirewallAccess,<br />\n&nbsp; &nbsp; [switch]$DisableBasicAuth = $false,<br />\n&nbsp; &nbsp; [switch]$EnableCredSSP<br />\n)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-Log<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-EventLog -LogName Application -Source $EventSource -EntryType Information -EventId 1 -Message $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-VerboseLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Verbose $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-HostLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Output $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function New-LegacySelfSignedCert<br />\n{<br />\n&nbsp; &nbsp; Param (<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [string]$SubjectName,<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [int]$ValidDays = 1095<br />\n&nbsp; &nbsp; )</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $hostnonFQDN = $env:computerName&nbsp;<br />\n&nbsp; &nbsp; $hostFQDN = [System.Net.Dns]::GetHostByName(($env:computerName)).Hostname<br />\n&nbsp; &nbsp; $SignatureAlgorithm = &quot;SHA256&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $name = New-Object -COM &quot;X509Enrollment.CX500DistinguishedName.1&quot;<br />\n&nbsp; &nbsp; $name.Encode(&quot;CN=$SubjectName&quot;, 0)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $key = New-Object -COM &quot;X509Enrollment.CX509PrivateKey.1&quot;<br />\n&nbsp; &nbsp; $key.ProviderName = &quot;Microsoft Enhanced RSA and AES Cryptographic Provider&quot;<br />\n&nbsp; &nbsp; $key.KeySpec = 1<br />\n&nbsp; &nbsp; $key.Length = 3072<br />\n&nbsp; &nbsp; $key.SecurityDescriptor = &quot;D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)&quot;<br />\n&nbsp; &nbsp; $key.MachineContext = 1<br />\n&nbsp; &nbsp; $key.ExportPolicy = 1<br />\n&nbsp; &nbsp; $key.Create()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $serverauthoid = New-Object -COM &quot;X509Enrollment.CObjectId.1&quot;<br />\n&nbsp; &nbsp; $serverauthoid.InitializeFromValue(&quot;1.3.6.1.5.5.7.3.1&quot;)<br />\n&nbsp; &nbsp; $ekuoids = New-Object -COM &quot;X509Enrollment.CObjectIds.1&quot;<br />\n&nbsp; &nbsp; $ekuoids.Add($serverauthoid)<br />\n&nbsp; &nbsp; $ekuext = New-Object -COM &quot;X509Enrollment.CX509ExtensionEnhancedKeyUsage.1&quot;<br />\n&nbsp; &nbsp; $ekuext.InitializeEncode($ekuoids)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert = New-Object -COM &quot;X509Enrollment.CX509CertificateRequestCertificate.1&quot;<br />\n&nbsp; &nbsp; $cert.InitializeFromPrivateKey(2, $key, &quot;&quot;)<br />\n&nbsp; &nbsp; $cert.Subject = $name<br />\n&nbsp; &nbsp; $cert.Issuer = $cert.Subject<br />\n&nbsp; &nbsp; $cert.NotBefore = (Get-Date).AddDays(-1)<br />\n&nbsp; &nbsp; $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SigOID = New-Object -ComObject X509Enrollment.CObjectId<br />\n&nbsp; &nbsp; $SigOID.InitializeFromValue(([Security.Cryptography.Oid]$SignatureAlgorithm).Value)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [string[]] $AlternativeName &nbsp;+= $hostnonFQDN<br />\n&nbsp; &nbsp; $AlternativeName += $hostFQDN<br />\n&nbsp; &nbsp; $IAlternativeNames = New-Object -ComObject X509Enrollment.CAlternativeNames</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; foreach ($AN in $AlternativeName)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName = New-Object -ComObject X509Enrollment.CAlternativeName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName.InitializeFromString(0x3,$AN)<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $IAlternativeNames.Add($AltName)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SubjectAlternativeName = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames<br />\n&nbsp; &nbsp; $SubjectAlternativeName.InitializeEncode($IAlternativeNames)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [String[]]$KeyUsage = (&quot;DigitalSignature&quot;, &quot;KeyEncipherment&quot;)<br />\n&nbsp; &nbsp; $KeyUsageObj = New-Object -ComObject X509Enrollment.CX509ExtensionKeyUsage<br />\n&nbsp; &nbsp; $KeyUsageObj.InitializeEncode([int][Security.Cryptography.X509Certificates.X509KeyUsageFlags]($KeyUsage))<br />\n&nbsp; &nbsp; $KeyUsageObj.Critical = $true</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert.X509Extensions.Add($KeyUsageObj)<br />\n&nbsp; &nbsp; $cert.X509Extensions.Add($ekuext)<br />\n&nbsp; &nbsp; $cert.SignatureInformation.HashAlgorithm = $SigOID<br />\n&nbsp; &nbsp; $CERT.X509Extensions.Add($SubjectAlternativeName)<br />\n&nbsp; &nbsp; $cert.Encode()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $enrollment = New-Object -COM &quot;X509Enrollment.CX509Enrollment.1&quot;<br />\n&nbsp; &nbsp; $enrollment.InitializeFromRequest($cert)<br />\n&nbsp; &nbsp; $certdata = $enrollment.CreateRequest(0)<br />\n&nbsp; &nbsp; $enrollment.InstallResponse(2, $certdata, 0, &quot;&quot;)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # extract/return the thumbprint from the generated cert<br />\n&nbsp; &nbsp; $parsed_cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2<br />\n&nbsp; &nbsp; $parsed_cert.Import([System.Text.Encoding]::UTF8.GetBytes($certdata))</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; return $parsed_cert.Thumbprint<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Enable-GlobalHttpFirewallAccess<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Forcing global HTTP firewall access&quot;<br />\n&nbsp; &nbsp; # this is a fairly naive implementation; could be more sophisticated about rule matching/collapsing<br />\n&nbsp; &nbsp; $fw = New-Object -ComObject HNetCfg.FWPolicy2</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # try to find/enable the default rule first<br />\n&nbsp; &nbsp; $add_rule = $false<br />\n&nbsp; &nbsp; $matching_rules = $fw.Rules | ? { $_.Name -eq &quot;Windows Remote Management (HTTP-In)&quot; }<br />\n&nbsp; &nbsp; $rule = $null<br />\n&nbsp; &nbsp; If ($matching_rules) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; If ($matching_rules -isnot [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing existing single HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Else {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # try to find one with the All or Public profile first<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Found multiple existing HTTP firewall rules...&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules | % { $_.Profiles -band 4 }[0]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (-not $rule -or $rule -is [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing an arbitrary single HTTP firewall rule (multiple existed)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # oh well, just pick the first one<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules[0]<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If (-not $rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Creating a new HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule = New-Object -ComObject HNetCfg.FWRule<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Name = &quot;Windows Remote Management (HTTP-In)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Description = &quot;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $add_rule = $true<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $rule.Profiles = 0x7FFFFFFF<br />\n&nbsp; &nbsp; $rule.Protocol = 6<br />\n&nbsp; &nbsp; $rule.LocalPorts = 5985<br />\n&nbsp; &nbsp; $rule.RemotePorts = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.LocalAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.RemoteAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.Enabled = $true<br />\n&nbsp; &nbsp; $rule.Direction = 1<br />\n&nbsp; &nbsp; $rule.Action = 1<br />\n&nbsp; &nbsp; $rule.Grouping = &quot;Windows Remote Management&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If ($add_rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $fw.Rules.Add($rule)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;HTTP firewall rule $($rule.Name) updated&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Setup error handling.<br />\nTrap<br />\n{<br />\n&nbsp; &nbsp; $_<br />\n&nbsp; &nbsp; Exit 1<br />\n}<br />\n$ErrorActionPreference = &quot;Stop&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the ID and security principal of the current user account<br />\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the security principal for the Administrator role<br />\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check to see if we are currently running &quot;as Administrator&quot;<br />\nif (-Not $myWindowsPrincipal.IsInRole($adminRole))<br />\n{<br />\n&nbsp; &nbsp; Write-Output &quot;ERROR: You need elevated Administrator privileges in order to run this script.&quot;<br />\n&nbsp; &nbsp; Write-Output &quot; &nbsp; &nbsp; &nbsp; Start Windows PowerShell by using the Run as Administrator option.&quot;<br />\n&nbsp; &nbsp; Exit 2<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$EventSource = $MyInvocation.MyCommand.Name<br />\nIf (-Not $EventSource)<br />\n{<br />\n&nbsp; &nbsp; $EventSource = &quot;Powershell CLI&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ([System.Diagnostics.EventLog]::Exists(&#39;Application&#39;) -eq $False -or [System.Diagnostics.EventLog]::SourceExists($EventSource) -eq $False)</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><u><span style=\"color:black\">{</span></u><br />\n<span style=\"color:black\">&nbsp; &nbsp; New-EventLog -LogName Application -Source $EventSource<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Detect PowerShell version.<br />\nIf ($PSVersionTable.PSVersion.Major -lt 3)<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:PowerShell version 3 or higher is required.&quot;<br />\n&nbsp; &nbsp; Throw &quot;PowerShell version 3 or higher is required.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Find and start the WinRM service.<br />\nWrite-Verbose &quot;Verifying WinRM service.&quot;<br />\nIf (!(Get-Service &quot;WinRM&quot;))<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to find the WinRM service.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to find the WinRM service.&quot;<br />\n}<br />\nElseIf ((Get-Service &quot;WinRM&quot;).Status -ne &quot;Running&quot;)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Setting WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Set-Service -Name &quot;WinRM&quot; -StartupType Automatic<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Set WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Write-Verbose &quot;Starting WinRM service.&quot;<br />\n&nbsp; &nbsp; Start-Service -Name &quot;WinRM&quot; -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Started WinRM service.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># WinRM should be running; check that we have a PS session config.<br />\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))<br />\n{<br />\n&nbsp; If ($SkipNetworkProfileCheck) {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting without checking Network profile.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting without checking Network profile.&quot;<br />\n&nbsp; }<br />\n&nbsp; Else {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting.&quot;<br />\n&nbsp; }<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;PS Remoting is already enabled.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Make sure there is a SSL listener.<br />\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener<br />\nIf (!($listeners | Where {$_.Keys -like &quot;TRANSPORT=HTTPS&quot;}))<br />\n{<br />\n&nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Create the hashtables of settings to be used.<br />\n&nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;Enabling SSL listener.&quot;<br />\n&nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled SSL listener.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;SSL listener is already active.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Force a new SSL cert on Listener if the $ForceNewSSLCert<br />\n&nbsp; &nbsp; If ($ForceNewSSLCert)<br />\n&nbsp; &nbsp; {</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Delete the listener for SSL<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Remove-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Add new Listener with new SSL cert<br />\n&nbsp; &nbsp; &nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check for basic authentication.<br />\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where-Object {$_.Name -eq &quot;Basic&quot;}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($DisableBasicAuth)&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $true)&nbsp;<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Disabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $false<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Disabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already disabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}&nbsp;<br />\nElse&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $true<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Enabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already enabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># If EnableCredSSP if set to true<br />\nIf ($EnableCredSSP)<br />\n{<br />\n&nbsp; &nbsp; # Check for CredSSP authentication<br />\n&nbsp; &nbsp; $credsspAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq &quot;CredSSP&quot;}<br />\n&nbsp; &nbsp; If (($credsspAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Enable-WSManCredSSP -role server -Force<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($GlobalHttpFirewallAccess) {<br />\n&nbsp; &nbsp; Enable-GlobalHttpFirewallAccess<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Configure firewall to allow WinRM HTTPS connections.<br />\n$fwtest1 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot;<br />\n$fwtest2 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot; profile=any<br />\nIf ($fwtest1.count -lt 5)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Adding firewall rule to allow WinRM HTTPS.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall add rule profile=any name=&quot;Allow WinRM HTTPS&quot; dir=in localport=5986 protocol=TCP action=allow</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Log &quot;Added firewall rule to allow WinRM HTTPS.&quot;<br />\n}<br />\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Updating firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall set rule name=&quot;Allow WinRM HTTPS&quot; new profile=any<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Updated firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Firewall rule already exists to allow WinRM HTTPS.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Test a remoting connection to localhost, which should work.<br />\n$httpResult = Invoke-Command -ComputerName &quot;localhost&quot; -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue<br />\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$httpsResult = New-PSSession -UseSSL -ComputerName &quot;localhost&quot; -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($httpResult -and $httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpsResult -and !$httpResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Disabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpResult -and !$httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Disabled&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n}<br />\nWrite-VerboseLog &quot;Pal-MDR:PS Remoting has been successfully configured.&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">netsh advfirewall firewall add rule profile=any name=&quot;Allow NetBIOS&quot; dir=in localport=135 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow NetBIOS(135).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow WinC&quot; dir=in localport=49153 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow WinC(49153).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow MessageQueue &quot; dir=out localport=61616 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow Outbound MessageQueue(61616).&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">winrm s winrm/config/service &#39;@{RootSDDL=&quot;O:NSG:BAD:P(A;;GX;;;S-1-5-21-3438187023-432945961-1320742929-1000)(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;}&#39;</span></span></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Run it from a PowerShell prompt (In Administrative Mode). If the script is successful, an HTTPS listener will be created for the WinRM service.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">NOTE: </span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Before executing the script, make sure to replace with the SID of the domain user created<strong> </strong>at the end of the script<strong>.</strong></span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" style=\"height:19px; width:624px\" /></span></span></span></strong></span></span></p>\n\n<ol>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:12.0pt\"><span style=\"color:#c10017\">3.1 Advanced Audit Policy Configuration</span></span></strong></span></span></li>\n</ol>\n\n<ol>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Audit Process Creation&rdquo; under Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration&gt; Audit Policies&gt; Detailed Tracking and</span></span> <span style=\"font-size:10.0pt\"><span style=\"color:black\">configure <em>Success and Failure</em> audit event</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Include command line in process creation event&rdquo; under Computer Configuration &gt; Policies &gt; Administrative Template &gt; System &gt; Audit Process Creation and enable the policy</span></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">5. Connectivity Requirements</span></span></span></strong></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:undefined; margin-left:19.6pt; width:516.8pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Source IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Protocol</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination Port</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Direction</span></span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">49153</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">135</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5985</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5986</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">61616</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\">Note:</span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\"> In case of &ldquo;Log Collector Server&rdquo; &amp; Windows Server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">6. Logging Guidelines</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Note:</span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"> The below mentioned logging guidelines are based on best practices for security monitoring. However, keep in mind that auditing events consumes system resources such as memory, processing power, and disk space. The more events you audit, the more of these resources are consumed. Auditing an excessive number of events can dramatically slow down your servers.</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625579706_windows4.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625579706_windows4.png\" style=\"height:450px; width:624px\" /></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\">&nbsp;</p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(62,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">1. Versions Supported</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Microsoft Windows Server 2008 R2 &amp; above, Microsoft Windows 7 &amp; above</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">2. Windows Hosts Prerequisites</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">.NET 4.5, 4.5.2, 4.6, or 4.6.1</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Minimum PowerShell version 3 and above</span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Note:</span></span></strong><span style=\"font-size:10.0pt\"><span style=\"color:black\"> In case of PowerShell version lesser than 3, use the below link for downloading and installation of WMF 5.1</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=54616\"><span style=\"font-size:10.0pt\"><span style=\"color:#0070c0\">https://www.microsoft.com/en-us/download/details.aspx?id=54616</span></span></a></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\">&nbsp;</p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">3. Log Forwarding Steps</span></span></span></strong></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Create a Read Only Domain User (username can be &ldquo;arcsight&rdquo;)</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Add the Domain User to <strong>&ldquo;Event Log Reader&rdquo;</strong> &amp; <strong>&ldquo;Windows Remote Management Users&rdquo;</strong> Group</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Enable windows auditing policy as per &ldquo;<strong>Logging Guidelines</strong>&rdquo; provided below</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Use the below providied&nbsp; to Invoke (Execute) permissions to Windows Remote Users Group on the respective windows servers and Configure WinRM HTTP &amp; HTTPS listeners on the windows servers</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Locate the &quot;</span><span style=\"font-size:9.0pt\">Manage auditing and security log</span><span style=\"font-size:10.0pt\">&quot;&nbsp;</span><span style=\"font-size:9.0pt\">policy&nbsp;under&nbsp;User Rights Assignment&nbsp;and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span> </span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;the&nbsp;&ldquo;Deny log on locally&rdquo;&nbsp;and&nbsp;&ldquo;Deny log on through Remote Desktop Services&rdquo;&nbsp;under&nbsp;User Rights Assignment&nbsp;and&nbsp;add the&nbsp;&ldquo;arcsight&rdquo;&nbsp;user&nbsp;</span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\">Locate&nbsp;&ldquo;Audit: Force audit policy subcategory settings&rdquo;&nbsp;under&nbsp;Computer Configuration &gt; Windows Settings &gt; Security settings&nbsp;&gt; Local Policies&nbsp;&gt;&nbsp;Security Options&nbsp;and enable&nbsp;the policy&nbsp;</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.0pt\"><span style=\"color:black\">Copy paste below Script and excute on powershell using elevation mode</span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Pal-MDR Windows Log forwarding enabling script</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">[CmdletBinding()]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Param (<br />\n&nbsp; &nbsp; [string]$SubjectName = $env:COMPUTERNAME,<br />\n&nbsp; &nbsp; [int]$CertValidityDays = 1095,<br />\n&nbsp; &nbsp; [switch]$SkipNetworkProfileCheck,<br />\n&nbsp; &nbsp; $CreateSelfSignedCert = $true,<br />\n&nbsp; &nbsp; [switch]$ForceNewSSLCert,<br />\n&nbsp; &nbsp; [switch]$GlobalHttpFirewallAccess,<br />\n&nbsp; &nbsp; [switch]$DisableBasicAuth = $false,<br />\n&nbsp; &nbsp; [switch]$EnableCredSSP<br />\n)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-Log<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-EventLog -LogName Application -Source $EventSource -EntryType Information -EventId 1 -Message $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-VerboseLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Verbose $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Write-HostLog<br />\n{<br />\n&nbsp; &nbsp; $Message = $args[0]<br />\n&nbsp; &nbsp; Write-Output $Message<br />\n&nbsp; &nbsp; Write-Log $Message<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function New-LegacySelfSignedCert<br />\n{<br />\n&nbsp; &nbsp; Param (<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [string]$SubjectName,<br />\n&nbsp; &nbsp; &nbsp; &nbsp; [int]$ValidDays = 1095<br />\n&nbsp; &nbsp; )</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $hostnonFQDN = $env:computerName&nbsp;<br />\n&nbsp; &nbsp; $hostFQDN = [System.Net.Dns]::GetHostByName(($env:computerName)).Hostname<br />\n&nbsp; &nbsp; $SignatureAlgorithm = &quot;SHA256&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $name = New-Object -COM &quot;X509Enrollment.CX500DistinguishedName.1&quot;<br />\n&nbsp; &nbsp; $name.Encode(&quot;CN=$SubjectName&quot;, 0)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $key = New-Object -COM &quot;X509Enrollment.CX509PrivateKey.1&quot;<br />\n&nbsp; &nbsp; $key.ProviderName = &quot;Microsoft Enhanced RSA and AES Cryptographic Provider&quot;<br />\n&nbsp; &nbsp; $key.KeySpec = 1<br />\n&nbsp; &nbsp; $key.Length = 3072<br />\n&nbsp; &nbsp; $key.SecurityDescriptor = &quot;D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)&quot;<br />\n&nbsp; &nbsp; $key.MachineContext = 1<br />\n&nbsp; &nbsp; $key.ExportPolicy = 1<br />\n&nbsp; &nbsp; $key.Create()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $serverauthoid = New-Object -COM &quot;X509Enrollment.CObjectId.1&quot;<br />\n&nbsp; &nbsp; $serverauthoid.InitializeFromValue(&quot;1.3.6.1.5.5.7.3.1&quot;)<br />\n&nbsp; &nbsp; $ekuoids = New-Object -COM &quot;X509Enrollment.CObjectIds.1&quot;<br />\n&nbsp; &nbsp; $ekuoids.Add($serverauthoid)<br />\n&nbsp; &nbsp; $ekuext = New-Object -COM &quot;X509Enrollment.CX509ExtensionEnhancedKeyUsage.1&quot;<br />\n&nbsp; &nbsp; $ekuext.InitializeEncode($ekuoids)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert = New-Object -COM &quot;X509Enrollment.CX509CertificateRequestCertificate.1&quot;<br />\n&nbsp; &nbsp; $cert.InitializeFromPrivateKey(2, $key, &quot;&quot;)<br />\n&nbsp; &nbsp; $cert.Subject = $name<br />\n&nbsp; &nbsp; $cert.Issuer = $cert.Subject<br />\n&nbsp; &nbsp; $cert.NotBefore = (Get-Date).AddDays(-1)<br />\n&nbsp; &nbsp; $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SigOID = New-Object -ComObject X509Enrollment.CObjectId<br />\n&nbsp; &nbsp; $SigOID.InitializeFromValue(([Security.Cryptography.Oid]$SignatureAlgorithm).Value)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [string[]] $AlternativeName &nbsp;+= $hostnonFQDN<br />\n&nbsp; &nbsp; $AlternativeName += $hostFQDN<br />\n&nbsp; &nbsp; $IAlternativeNames = New-Object -ComObject X509Enrollment.CAlternativeNames</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; foreach ($AN in $AlternativeName)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName = New-Object -ComObject X509Enrollment.CAlternativeName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $AltName.InitializeFromString(0x3,$AN)<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $IAlternativeNames.Add($AltName)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $SubjectAlternativeName = New-Object -ComObject X509Enrollment.CX509ExtensionAlternativeNames<br />\n&nbsp; &nbsp; $SubjectAlternativeName.InitializeEncode($IAlternativeNames)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; [String[]]$KeyUsage = (&quot;DigitalSignature&quot;, &quot;KeyEncipherment&quot;)<br />\n&nbsp; &nbsp; $KeyUsageObj = New-Object -ComObject X509Enrollment.CX509ExtensionKeyUsage<br />\n&nbsp; &nbsp; $KeyUsageObj.InitializeEncode([int][Security.Cryptography.X509Certificates.X509KeyUsageFlags]($KeyUsage))<br />\n&nbsp; &nbsp; $KeyUsageObj.Critical = $true</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $cert.X509Extensions.Add($KeyUsageObj)<br />\n&nbsp; &nbsp; $cert.X509Extensions.Add($ekuext)<br />\n&nbsp; &nbsp; $cert.SignatureInformation.HashAlgorithm = $SigOID<br />\n&nbsp; &nbsp; $CERT.X509Extensions.Add($SubjectAlternativeName)<br />\n&nbsp; &nbsp; $cert.Encode()</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $enrollment = New-Object -COM &quot;X509Enrollment.CX509Enrollment.1&quot;<br />\n&nbsp; &nbsp; $enrollment.InitializeFromRequest($cert)<br />\n&nbsp; &nbsp; $certdata = $enrollment.CreateRequest(0)<br />\n&nbsp; &nbsp; $enrollment.InstallResponse(2, $certdata, 0, &quot;&quot;)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # extract/return the thumbprint from the generated cert<br />\n&nbsp; &nbsp; $parsed_cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2<br />\n&nbsp; &nbsp; $parsed_cert.Import([System.Text.Encoding]::UTF8.GetBytes($certdata))</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; return $parsed_cert.Thumbprint<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Function Enable-GlobalHttpFirewallAccess<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Forcing global HTTP firewall access&quot;<br />\n&nbsp; &nbsp; # this is a fairly naive implementation; could be more sophisticated about rule matching/collapsing<br />\n&nbsp; &nbsp; $fw = New-Object -ComObject HNetCfg.FWPolicy2</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # try to find/enable the default rule first<br />\n&nbsp; &nbsp; $add_rule = $false<br />\n&nbsp; &nbsp; $matching_rules = $fw.Rules | ? { $_.Name -eq &quot;Windows Remote Management (HTTP-In)&quot; }<br />\n&nbsp; &nbsp; $rule = $null<br />\n&nbsp; &nbsp; If ($matching_rules) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; If ($matching_rules -isnot [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing existing single HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Else {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # try to find one with the All or Public profile first<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Found multiple existing HTTP firewall rules...&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules | % { $_.Profiles -band 4 }[0]</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (-not $rule -or $rule -is [Array]) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Editing an arbitrary single HTTP firewall rule (multiple existed)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # oh well, just pick the first one<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rule = $matching_rules[0]<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If (-not $rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Creating a new HTTP firewall rule&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule = New-Object -ComObject HNetCfg.FWRule<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Name = &quot;Windows Remote Management (HTTP-In)&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $rule.Description = &quot;Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $add_rule = $true<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $rule.Profiles = 0x7FFFFFFF<br />\n&nbsp; &nbsp; $rule.Protocol = 6<br />\n&nbsp; &nbsp; $rule.LocalPorts = 5985<br />\n&nbsp; &nbsp; $rule.RemotePorts = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.LocalAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.RemoteAddresses = &quot;*&quot;<br />\n&nbsp; &nbsp; $rule.Enabled = $true<br />\n&nbsp; &nbsp; $rule.Direction = 1<br />\n&nbsp; &nbsp; $rule.Action = 1<br />\n&nbsp; &nbsp; $rule.Grouping = &quot;Windows Remote Management&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; If ($add_rule) {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $fw.Rules.Add($rule)<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;HTTP firewall rule $($rule.Name) updated&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Setup error handling.<br />\nTrap<br />\n{<br />\n&nbsp; &nbsp; $_<br />\n&nbsp; &nbsp; Exit 1<br />\n}<br />\n$ErrorActionPreference = &quot;Stop&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the ID and security principal of the current user account<br />\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Get the security principal for the Administrator role<br />\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check to see if we are currently running &quot;as Administrator&quot;<br />\nif (-Not $myWindowsPrincipal.IsInRole($adminRole))<br />\n{<br />\n&nbsp; &nbsp; Write-Output &quot;ERROR: You need elevated Administrator privileges in order to run this script.&quot;<br />\n&nbsp; &nbsp; Write-Output &quot; &nbsp; &nbsp; &nbsp; Start Windows PowerShell by using the Run as Administrator option.&quot;<br />\n&nbsp; &nbsp; Exit 2<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$EventSource = $MyInvocation.MyCommand.Name<br />\nIf (-Not $EventSource)<br />\n{<br />\n&nbsp; &nbsp; $EventSource = &quot;Powershell CLI&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ([System.Diagnostics.EventLog]::Exists(&#39;Application&#39;) -eq $False -or [System.Diagnostics.EventLog]::SourceExists($EventSource) -eq $False)</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><u><span style=\"color:black\">{</span></u><br />\n<span style=\"color:black\">&nbsp; &nbsp; New-EventLog -LogName Application -Source $EventSource<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Detect PowerShell version.<br />\nIf ($PSVersionTable.PSVersion.Major -lt 3)<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:PowerShell version 3 or higher is required.&quot;<br />\n&nbsp; &nbsp; Throw &quot;PowerShell version 3 or higher is required.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Find and start the WinRM service.<br />\nWrite-Verbose &quot;Verifying WinRM service.&quot;<br />\nIf (!(Get-Service &quot;WinRM&quot;))<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to find the WinRM service.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to find the WinRM service.&quot;<br />\n}<br />\nElseIf ((Get-Service &quot;WinRM&quot;).Status -ne &quot;Running&quot;)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Setting WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Set-Service -Name &quot;WinRM&quot; -StartupType Automatic<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Set WinRM service to start automatically on boot.&quot;<br />\n&nbsp; &nbsp; Write-Verbose &quot;Starting WinRM service.&quot;<br />\n&nbsp; &nbsp; Start-Service -Name &quot;WinRM&quot; -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Started WinRM service.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># WinRM should be running; check that we have a PS session config.<br />\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))<br />\n{<br />\n&nbsp; If ($SkipNetworkProfileCheck) {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting without checking Network profile.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting without checking Network profile.&quot;<br />\n&nbsp; }<br />\n&nbsp; Else {<br />\n&nbsp; &nbsp; Write-Verbose &quot;Enabling PS Remoting.&quot;<br />\n&nbsp; &nbsp; Enable-PSRemoting -Force -ErrorAction Stop<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled PS Remoting.&quot;<br />\n&nbsp; }<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;PS Remoting is already enabled.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Make sure there is a SSL listener.<br />\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener<br />\nIf (!($listeners | Where {$_.Keys -like &quot;TRANSPORT=HTTPS&quot;}))<br />\n{<br />\n&nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Create the hashtables of settings to be used.<br />\n&nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Verbose &quot;Enabling SSL listener.&quot;<br />\n&nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled SSL listener.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;SSL listener is already active.&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; # Force a new SSL cert on Listener if the $ForceNewSSLCert<br />\n&nbsp; &nbsp; If ($ForceNewSSLCert)<br />\n&nbsp; &nbsp; {</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # We cannot use New-SelfSignedCertificate on 2012R2 and earlier<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName -ValidDays $CertValidityDays<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-HostLog &quot;Self-signed SSL certificate generated; thumbprint: $thumbprint&quot;</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; $valueset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CertificateThumbprint = $thumbprint<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hostname = $SubjectName<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Delete the listener for SSL<br />\n&nbsp; &nbsp; &nbsp; &nbsp; $selectorset = @{<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address = &quot;*&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Transport = &quot;HTTPS&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; }<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Remove-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; &nbsp; &nbsp; # Add new Listener with new SSL cert<br />\n&nbsp; &nbsp; &nbsp; &nbsp; New-WSManInstance -ResourceURI &#39;winrm/config/Listener&#39; -SelectorSet $selectorset -ValueSet $valueset<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Check for basic authentication.<br />\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where-Object {$_.Name -eq &quot;Basic&quot;}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($DisableBasicAuth)&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $true)&nbsp;<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Disabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $false<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Disabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already disabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}&nbsp;<br />\nElse&nbsp;<br />\n{<br />\n&nbsp; &nbsp; If (($basicAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling basic auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Set-Item -Path &quot;WSMan:\\localhost\\Service\\Auth\\Basic&quot; -Value $true<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Enabled basic auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n&nbsp; &nbsp; Else<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Basic auth is already enabled.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># If EnableCredSSP if set to true<br />\nIf ($EnableCredSSP)<br />\n{<br />\n&nbsp; &nbsp; # Check for CredSSP authentication<br />\n&nbsp; &nbsp; $credsspAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq &quot;CredSSP&quot;}<br />\n&nbsp; &nbsp; If (($credsspAuthSetting.Value) -eq $false)<br />\n&nbsp; &nbsp; {<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Verbose &quot;Enabling CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Enable-WSManCredSSP -role server -Force<br />\n&nbsp; &nbsp; &nbsp; &nbsp; Write-Log &quot;Pal-MDR:Enabled CredSSP auth support.&quot;<br />\n&nbsp; &nbsp; }<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($GlobalHttpFirewallAccess) {<br />\n&nbsp; &nbsp; Enable-GlobalHttpFirewallAccess<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Configure firewall to allow WinRM HTTPS connections.<br />\n$fwtest1 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot;<br />\n$fwtest2 = netsh advfirewall firewall show rule name=&quot;Allow WinRM HTTPS&quot; profile=any<br />\nIf ($fwtest1.count -lt 5)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Adding firewall rule to allow WinRM HTTPS.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall add rule profile=any name=&quot;Allow WinRM HTTPS&quot; dir=in localport=5986 protocol=TCP action=allow</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">&nbsp; &nbsp; Write-Log &quot;Added firewall rule to allow WinRM HTTPS.&quot;<br />\n}<br />\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Updating firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n&nbsp; &nbsp; netsh advfirewall firewall set rule name=&quot;Allow WinRM HTTPS&quot; new profile=any<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Updated firewall rule to allow WinRM HTTPS for any profile.&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;Firewall rule already exists to allow WinRM HTTPS.&quot;<br />\n}</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"># Test a remoting connection to localhost, which should work.<br />\n$httpResult = Invoke-Command -ComputerName &quot;localhost&quot; -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue<br />\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">$httpsResult = New-PSSession -UseSSL -ComputerName &quot;localhost&quot; -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">If ($httpResult -and $httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpsResult -and !$httpResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Disabled | HTTPS: Enabled&quot;<br />\n}<br />\nElseIf ($httpResult -and !$httpsResult)<br />\n{<br />\n&nbsp; &nbsp; Write-Verbose &quot;HTTP: Enabled | HTTPS: Disabled&quot;<br />\n}<br />\nElse<br />\n{<br />\n&nbsp; &nbsp; Write-Log &quot;Pal-MDR:Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n&nbsp; &nbsp; Throw &quot;Unable to establish an HTTP or HTTPS remoting session.&quot;<br />\n}<br />\nWrite-VerboseLog &quot;Pal-MDR:PS Remoting has been successfully configured.&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">netsh advfirewall firewall add rule profile=any name=&quot;Allow NetBIOS&quot; dir=in localport=135 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow NetBIOS(135).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow WinC&quot; dir=in localport=49153 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow WinC(49153).&quot;<br />\nnetsh advfirewall firewall add rule profile=any name=&quot;Allow MessageQueue &quot; dir=out localport=61616 protocol=TCP action=allow<br />\nWrite-Log &quot;Pal-MDR:Added firewall rule to allow Outbound MessageQueue(61616).&quot;</span></span></span><br />\n<span style=\"font-size:7.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">winrm s winrm/config/service &#39;@{RootSDDL=&quot;O:NSG:BAD:P(A;;GX;;;S-1-5-21-3438187023-432945961-1320742929-1000)(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;}&#39;</span></span></span></span></span></p>\n\n<ul>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\">Run it from a PowerShell prompt (In Administrative Mode). If the script is successful, an HTTPS listener will be created for the WinRM service.</span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">NOTE: </span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Before executing the script, make sure to replace with the SID of the domain user created<strong> </strong>at the end of the script<strong>.</strong></span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625545462_windows1.png\" style=\"height:19px; width:624px\" /></span></span></span></strong></span></span></p>\n\n<ol>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:12.0pt\"><span style=\"color:#c10017\">3.1 Advanced Audit Policy Configuration</span></span></strong></span></span></li>\n</ol>\n\n<ol>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Audit Process Creation&rdquo; under Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration&gt; Audit Policies&gt; Detailed Tracking and</span></span> <span style=\"font-size:10.0pt\"><span style=\"color:black\">configure <em>Success and Failure</em> audit event</span></span></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style=\"color:black\">Locate &ldquo;Include command line in process creation event&rdquo; under Computer Configuration &gt; Policies &gt; Administrative Template &gt; System &gt; Audit Process Creation and enable the policy</span></span></span></span></li>\n</ol>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">5. Connectivity Requirements</span></span></span></strong></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:undefined; margin-left:19.6pt; width:516.8pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Source IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Protocol</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination Port</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Direction</span></span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">49153</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">135</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5985</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">5986</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Windows Servers</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">61616</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:176.6pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\">Note:</span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Times New Roman&quot;,&quot;serif&quot;\"><span style=\"color:black\"> In case of &ldquo;Log Collector Server&rdquo; &amp; Windows Server to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integration.</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in; text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">6. Logging Guidelines</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Note:</span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"> The below mentioned logging guidelines are based on best practices for security monitoring. However, keep in mind that auditing events consumes system resources such as memory, processing power, and disk space. The more events you audit, the more of these resources are consumed. Auditing an excessive number of events can dramatically slow down your servers.</span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><img alt=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625579706_windows4.png\" src=\"https://mdr-connect.paladion.net:5000/uploads/icon_image-1549625579706_windows4.png\" style=\"height:450px; width:624px\" /></span></span></span></span></p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL),(63,'Test','Test','<html>\n<head>\n	<title></title>\n</head>\n<body>\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">1. Versions Supported</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Microsoft Exchange Servers 2007, 2010, 2013, 2013 SP1 &amp; 2016</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">2. Configuration</span></span></span></strong></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>&nbsp;</strong><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Enable Message Tracking for Exchange 2016 Using EAC</span></span></span></strong></span></span></p>\n\n<ul style=\"list-style-type:circle\">\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Open the EAC and navigate to&nbsp;<strong>Servers</strong>&nbsp;&gt;&nbsp;<strong>Servers</strong>&nbsp;&gt; select the Mailbox server that you want to configure &gt; and click&nbsp;<strong>Edit</strong></span></span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">On the server properties page, click&nbsp;<strong>Transport Logs</strong>. In the&nbsp;<strong>Message tracking log</strong>&nbsp;section, change any of the following settings:-</span></span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Enable message tracking log</span></span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">: To disable message tracking on the server, clear the check box. To enable message tracking on the server, select the check box</span></span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Message tracking log path</span></span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">: The value you specify must be on the local Exchange server. If the folder doesn&#39;t exist, it&#39;s created for you when you click&nbsp;<strong>Save</strong></span></span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">When you&#39;re finished, click</span></span></span></span>&nbsp;<span style=\"font-size:9.0pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Save</span></span></span></span></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:10.5pt\"><span style=\"background-color:white\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Enable Message Tracking for Exchange 2013 SP1 and earlier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span></span></strong><strong>&nbsp; </strong></span></span></p>\n\n<ul>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\">&nbsp;<span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">In the Exchange System Manager, right-click an Exchange server, then select Properties.</span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\">&nbsp;<span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">On the General tab, select the Enable message tracking check box.</span></span></span></span></span></li>\n	<li><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">I<span style=\"font-family:Arial,Helvetica,sans-serif\">n </span>the Remove files older than (days) text box, enter the number of days that you want the files to remain on the server before being deleted.</span></span></span>&nbsp;&nbsp;</span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Locate&nbsp;the&nbsp;<strong>&ldquo;Deny log on locally&rdquo;&nbsp;</strong>and<strong>&nbsp;&ldquo;Deny log on through Remote Desktop Services&rdquo;&nbsp;</strong>under&nbsp;<strong>User Rights Assignment</strong>&nbsp;and&nbsp;add the&nbsp;<strong>&ldquo;arcsight&rdquo;</strong>&nbsp;user</span></span></span><strong>&nbsp;</strong></span></span></li>\n</ul>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:13.5pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#c10017\">3. Connectivity Requirements</span></span></span></strong></span></span></p>\n\n<table cellspacing=\"0\" class=\"Table\" style=\"border-collapse:collapse; border:undefined; margin-left:19.6pt; width:460.7pt\">\n	<tbody>\n		<tr>\n			<td style=\"background-color:#c00000; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Source IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination IP</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Protocol</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Destination Port</span></span></span></strong></span></span></p>\n			</td>\n			<td style=\"background-color:#c00000; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:white\">Direction</span></span></span></strong></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"background-color:#f2f2f2; width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Exchange Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">445</span></span></span></span></span></p>\n			</td>\n			<td style=\"background-color:#f2f2f2; width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n		<tr>\n			<td style=\"width:99.25pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Log Collector Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:99.2pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Exchange Server</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:56.7pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">TCP</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:85.05pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">139</span></span></span></span></span></p>\n			</td>\n			<td style=\"width:120.5pt\">\n			<p style=\"margin-left:0in; margin-right:0in; text-align:center\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:#262626\">Unidirectional (Stateful)</span></span></span></span></span></p>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Note:</span></span></span></strong><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\"> In case of &ldquo;Log Collector Server&rdquo; &amp; &ldquo;Exchange Server&rdquo; to be integrated are in different subnets, above mentioned network port access connectivity shall be required for integrat</span></span></span></span></span></p>\n\n<ol start=\"7\">\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Locate&nbsp;<strong>&ldquo;Audit: Force audit policy subcategory settings&rdquo;&nbsp;</strong>under<strong>&nbsp;Computer Configuration &gt; Windows Settings &gt; Security settings&nbsp;&gt; Local Policies&nbsp;&gt;&nbsp;Security Options&nbsp;</strong>and enable&nbsp;the policy</span></span></span><strong>&nbsp;</strong></span></span></li>\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Locate&nbsp;the&nbsp;<strong>&ldquo;Deny log on locally&rdquo;&nbsp;</strong>and<strong>&nbsp;&ldquo;Deny log on through Remote Desktop Services&rdquo;&nbsp;</strong>under&nbsp;<strong>User Rights Assignment</strong>&nbsp;and&nbsp;add the&nbsp;<strong>&ldquo;arcsight&rdquo;</strong>&nbsp;user</span></span></span><strong>&nbsp;</strong></span></span></li>\n</ol>\n\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><strong>bbdsahdkjsajkdhjskahhjk</strong></span></span></p>\n\n<p style=\"text-align:justify\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>\n\n<ol start=\"7\">\n	<li style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">Locate&nbsp;<strong>&ldquo;Audit: Force audit policy subcategory settings&rdquo;&nbsp;</strong>under<strong>&nbsp;Computer Configuration &gt; Windows Settings &gt; Security settings&nbsp;&gt; Local Policies&nbsp;&gt;&nbsp;Security Options&nbsp;</strong>and enable&nbsp;the policy</span></span></span><strong>&nbsp;</strong></span></span></li>\n</ol>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">gdshgdghsadhashdsahj</span></span></span></span></span></p>\n\n<p style=\"margin-left:0in; margin-right:0in\"><span style=\"font-size:11pt\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:9.0pt\"><span style=\"font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span style=\"color:black\">khkjdshkdss</span></span></span></span></span></p>\n</body>\n</html>\n',5,14,NULL,1,NULL,NULL);
/*!40000 ALTER TABLE `mdr` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `mdrtype`
--

DROP TABLE IF EXISTS `mdrtype`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `mdrtype` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `mdr_type_name` varchar(255) DEFAULT NULL,
  `createdAt` datetime DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `mdrtype`
--

LOCK TABLES `mdrtype` WRITE;
/*!40000 ALTER TABLE `mdrtype` DISABLE KEYS */;
INSERT INTO `mdrtype` VALUES (1,'tm',NULL,NULL),(2,'vm',NULL,NULL);
/*!40000 ALTER TABLE `mdrtype` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `project_summary`
--

DROP TABLE IF EXISTS `project_summary`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `project_summary` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `cust_name` varchar(255) DEFAULT NULL,
  `project_name` varchar(255) DEFAULT NULL,
  `region` varchar(255) DEFAULT NULL,
  `Country` varchar(255) DEFAULT NULL,
  `project_manager` varchar(255) DEFAULT NULL,
  `imp_engineer_email` varchar(255) DEFAULT NULL,
  `project_status` varchar(45) DEFAULT NULL,
  `planned_start_date` datetime DEFAULT NULL,
  `planned_end_date` datetime DEFAULT NULL,
  `actual_start_date` datetime DEFAULT NULL,
  `actual_end_date` datetime DEFAULT NULL,
  `mdr_type_id` int(11) NOT NULL,
  `order` int(11) NOT NULL,
  PRIMARY KEY (`id`,`mdr_type_id`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  UNIQUE KEY `order_UNIQUE` (`order`)
) ENGINE=InnoDB AUTO_INCREMENT=76 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `project_summary`
--

LOCK TABLES `project_summary` WRITE;
/*!40000 ALTER TABLE `project_summary` DISABLE KEYS */;
INSERT INTO `project_summary` VALUES (1,'ghghj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,2,1),(2,'dsad',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,3,36),(73,'','change the font color','','','','','',NULL,NULL,NULL,NULL,1,37),(74,'','','','','','','Completed',NULL,NULL,NULL,NULL,1,38),(75,'','','','','','','On Hold',NULL,NULL,NULL,NULL,1,39);
/*!40000 ALTER TABLE `project_summary` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `sequelizemeta`
--

DROP TABLE IF EXISTS `sequelizemeta`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `sequelizemeta` (
  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`name`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `sequelizemeta`
--

LOCK TABLES `sequelizemeta` WRITE;
/*!40000 ALTER TABLE `sequelizemeta` DISABLE KEYS */;
INSERT INTO `sequelizemeta` VALUES ('20181102092556-create-user.js'),('20181102092608-create-mdr-type.js'),('20181102092713-create-category.js'),('20181102092719-create-type.js'),('20181102092725-create-mdr.js'),('20181102093217-create-page.js'),('20181102093229-create-faq.js'),('20181125054636-create-icon.js');
/*!40000 ALTER TABLE `sequelizemeta` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `type`
--

DROP TABLE IF EXISTS `type`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `type_name` varchar(255) DEFAULT NULL,
  `type_image` text,
  `category_id` int(11) NOT NULL,
  `mdr_type_id` int(11) NOT NULL,
  `createdAt` datetime DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`,`category_id`,`mdr_type_id`),
  KEY `category_id` (`category_id`),
  KEY `mdr_type_id` (`mdr_type_id`),
  CONSTRAINT `Type_ibfk_1` FOREIGN KEY (`category_id`) REFERENCES `category` (`id`) ON DELETE CASCADE,
  CONSTRAINT `Type_ibfk_2` FOREIGN KEY (`mdr_type_id`) REFERENCES `mdrtype` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=35 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `type`
--

LOCK TABLES `type` WRITE;
/*!40000 ALTER TABLE `type` DISABLE KEYS */;
INSERT INTO `type` VALUES (5,'Forcepoint V 8.0 and above','https://mdr-connect.paladion.net:5000/uploads/type_image-1549277261426_forcepoint.jpeg',14,1,NULL,NULL),(6,'Zscalar V 4.1 and above','https://mdr-connect.paladion.net:5000/uploads/type_image-1549277297462_zscaler-logo.jpeg',14,1,NULL,NULL),(10,'Check Point R77.30 and R80.10','https://mdr-connect.paladion.net:5000/uploads/type_image-1549277486542_checkpoint.jpeg',15,1,NULL,NULL),(11,'Fortinet 5.0 and 5.2','https://mdr-connect.paladion.net:5000/uploads/type_image-1549277517539_forti.jpeg',15,1,NULL,NULL),(12,'Cisco ASA versions 8.2 to 9.6','https://mdr-connect.paladion.net:5000/uploads/type_image-1549277562077_cisco.jpeg',15,1,NULL,NULL),(13,'LEC VM ','https://mdr-connect.paladion.net:5000/uploads/type_image-1549612789507_VM-Icon.png',17,1,NULL,NULL),(18,'Palo Alto','https://mdr-connect.paladion.net:5000/uploads/type_image-1549617497745_Palo-Alto-Logo-300x130.png',15,1,NULL,NULL),(19,'Windows','https://mdr-connect.paladion.net:5000/uploads/type_image-1549621136525_windows.jpeg',16,1,NULL,NULL),(20,'Blue Coat Proxy SG','https://mdr-connect.paladion.net:5000/uploads/type_image-1549865513363_Bluecoat.jpeg',14,1,NULL,NULL),(21,'Linux','https://mdr-connect.paladion.net:5000/uploads/type_image-1549866163235_linux.jpeg',16,1,NULL,NULL),(22,'Aruba Networks','https://mdr-connect.paladion.net:5000/uploads/type_image-1549885012343_kisspng-hewlett-packard-aruba-networks-logo-wireless-acces-arubalarge-iot-line-fair-5b68bcc75932e9.6525056115335907273654.png',18,1,NULL,NULL),(23,'Cisco - Catalyst','https://mdr-connect.paladion.net:5000/uploads/type_image-1549886317650_cisco.jpeg',19,1,NULL,NULL),(26,'Cisco','https://mdr-connect.paladion.net:5000/uploads/type_image-1549976028308_cisco.jpeg',18,1,NULL,NULL),(27,'Citrix','https://mdr-connect.paladion.net:5000/uploads/type_image-1550127823811_Citrix.JPEG',20,1,NULL,NULL),(28,'Dell','https://mdr-connect.paladion.net:5000/uploads/type_image-1550128116936_Dell.png',21,1,NULL,NULL),(29,'F5 Networks','https://mdr-connect.paladion.net:5000/uploads/type_image-1550128754737_f5-networks-logo.gif',20,1,NULL,NULL),(30,'FireEye','https://mdr-connect.paladion.net:5000/uploads/type_image-1550130750723_FireEye_logo_logotipo-700x203.png',23,1,NULL,NULL),(31,'F5 Networks','https://mdr-connect.paladion.net:5000/uploads/type_image-1550137764564_f5-networks-logo.gif',22,1,NULL,NULL),(32,'McAfee ','https://mdr-connect.paladion.net:5000/uploads/type_image-1550139631420_McAfee.png',24,1,NULL,NULL),(33,'McAfee','https://mdr-connect.paladion.net:5000/uploads/type_image-1550141834845_McAfee.png',21,1,NULL,NULL),(34,'Microsoft Exchange','https://mdr-connect.paladion.net:5000/uploads/type_image-1550144754102_microsoft-exchange-logo-png--1608.png',16,1,NULL,NULL);
/*!40000 ALTER TABLE `type` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user`
--

DROP TABLE IF EXISTS `user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_name` varchar(255) DEFAULT NULL,
  `password` varchar(255) DEFAULT NULL,
  `createdAt` datetime DEFAULT NULL,
  `updatedAt` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user`
--

LOCK TABLES `user` WRITE;
/*!40000 ALTER TABLE `user` DISABLE KEYS */;
/*!40000 ALTER TABLE `user` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2021-04-24 23:16:44
